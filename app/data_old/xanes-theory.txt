## Abstract
The physics of x-ray absorption near-edge structure (XANES) spectra is described briefly using the multiple-scattering (MS) approach. This method is used for calculations of the scattering processes in small clusters of atoms. Further, the differences between XANES and x-ray absorption fine structure (EXAFS) regimes are pointed out. A few illustrative examples of Zn XANES spectra are shown and the reasons for differences among them are discussed. At the end, a comparison is made between the calculated and measured spectra of ZnO, and a comment is made on the failures of the muffin-tin approximation.

## 1 Conventions
Rydberg atomic units (ℏ = e₀ = mₑ = 1, c = 2/α = 2·137.036) are used throughout the following two sections: distances are expressed as multiples of Bohr’s radius a₀ and energies are measured in rydbergs, a₀ = 4πϵ₀ℏ²/(e₀²mₑ) = 0.529177·10⁻¹⁰ m, 1 ry = ℏ²/(2mₑa₀²) = 13.6058 eV. The kinetic energy operator thus obtains the form H₀ = −∇² and a free electron’s wave number k is in simple relation with its (kinetic) energy E: k = √E. Furthermore, we will use L to denote a pair L = (l, m), where l and m are the orbital and magnetic quantum numbers, respectively. Finally, vectors and matrices (or, more generally, tensors) will be written in bold, for example r, G₀, etc.

## 2 Introduction
Especially in the last decades, x-ray absorption spectrometry has gained much of its reputation as a powerful analytical and research tool, mostly due to the use of synchrotron radiation sources. In this kind of spectrometry, interactions of photons with matter are studied by measuring the photoabsorption cross-section. For incident light with polarization ε̂ and frequency ω the cross section is given by Fermi’s golden rule σ = (4π²/ω) Σ_f |〈f|ε̂·p e^{ik·r}|i〉|² δ(E_i−E_f+ω) ≡ Σ_f |〈f|D|i〉|² δ(E_i−E_f+ω) (1), where |i〉, |f〉, E_i, and E_f denote the initial and final states and their energies; k stands for the wave vector of the incident beam. Only the dipole contribution to the total cross-section has been considered in Eq. (1).

By exciting an atom using an x-ray source, the electron configuration of the atom is changed; one (usually a core-shell) electron or more electrons populate unoccupied bound or continuum states. The success of this spectrometry lies in the fact that the photoelectrons act as very sensitive probes that can “feel” the charge distribution and the arrangement of the neighbouring atoms around the absorbing atom—that is, they can feel the chemical environment. When the photon energy is large enough, the photoeffect in one of the core shells can occur, resulting in the step-like shape of the absorption spectrum: the increased photoabsorption cross-section due to the knocking-out of an electron is called the absorption edge.

When the photon energy ω is low, the photoelectrons can populate either unoccupied bound states or low-lying continuum states. This part of the spectrum is called the XANES region; the acronym stands for X-ray Absorption Near-Edge Structure. On its high-energy end, XANES extends up to Extended X-ray Absorption Fine Structure (EXAFS), where the photoelectron kinetic energy is high. The limiting energy that divides XANES from EXAFS is by no means exactly defined since the transition from one regime to the other is smooth: as ω is increased, the transition starts happening gradually. As a rule of thumb, near-edge structure ends approximately where the electron wavelength equals the distance from the absorbing atom to its nearest neighbours, which usually means about 40–50 eV above the edge. In the XANES regime, the electron’s kinetic energy is small and the scattering on the neighbouring atoms tends to be strong for this reason, while the effect of the scatterers becomes smaller at higher energies; in the EXAFS region, the photoelectrons are only weakly scattered. The underlying theory is the same in both cases, but complications arise at low energies because the usual Born-like scattering expansion is divergent.# 3 The theory of XANES

## 3.1 Multiple scattering formalism
In this section we discuss scattering from potentials \(v_i\) of several atoms or ions, each of which makes a non-zero contribution only within a spherically non-overlapping scattering region of finite radius (Fig. 3), \(V = \sum_i v_i\) (2). Outside the spherical regions—in the interstitial region—the potential is set to zero. This approximation is often used when describing condensed materials and is known as the muffin-tin approximation. The scattering parameters of each of the scatterers, i.e., the scattering amplitudes and phase shifts, are determined separately for each scatterer and are therefore pure atomic quantities.

Propagation of a photoelectron in such muffin-tin potential \(V\) is described by the Hamiltonian \(H = H_0 + V\) (3), where \(H_0\) is the kinetic-energy operator. One is seeking the stationary solution \(\lvert \psi \rangle\) with energy \(E\), \(H\lvert \psi \rangle = E\lvert \psi \rangle\) (4), which can be rewritten as \((E - H_0)\lvert \psi \rangle = V\lvert \psi \rangle\) (5). Writing the equation this way suggests treating \(V\lvert \psi \rangle\) as a source and solving the inhomogeneous equation by means of Green’s functions: if \(\langle r \rvert \phi \rangle\) is the solution of the homogeneous part \((E - H_0)\langle r \rvert \phi \rangle = 0\) (6) and the free-electron Green’s function \(G_0\) is defined by \((E - H_0)G_0(r,r';E)\equiv (\nabla^2 + k^2)G_0(r,r';E) = \delta(r - r')\) (7), then the general solution is given by \(\langle r \rvert \psi \rangle = \langle r \rvert \phi \rangle + \int d^3r'\,G_0(r,r';E)\,\langle r' \rvert V \lvert \psi \rangle\) (8).

If the photoelectron is only weakly scattered by the potential \(V\), the solution \(\langle r \rvert \psi \rangle\) is close to the free-electron solution \(\langle r \rvert \phi \rangle\). When \(V\) is zero everywhere, the exact equality \(\langle r \rvert \psi \rangle = \langle r \rvert \phi \rangle\) holds. It is apparent from Eqs. (4) and (6) that we look only for solutions of the total Hamiltonian \(\lvert \psi \rangle\) that have the same energy as \(\lvert \phi \rangle\), i.e., we consider only elastic scattering.

The formal solution of the operator equation \((E - H_0)\lvert \psi \rangle = V\lvert \psi \rangle\) is given by the Lippmann–Schwinger equation \(\lvert \psi \rangle = \lvert \phi \rangle + \frac{1}{E - H_0 \pm i\eta}\,V\lvert \psi \rangle\) (9). Because of its singularity, the operator \(1/(E - H_0)\) has been modified by an imaginary term \(\pm i\eta\) in the denominator, with \(\eta\to0^+\). Comparison with Eq. (8) reveals that \(G_0^\pm(r,r';E)=\langle r\rvert\frac{1}{E-H_0\pm i\eta}\rvert r'\rangle\) and \(G_0^\pm=\frac{1}{E-H_0\pm i\eta}\) (10). The meaning of the superscript “\(\pm\)” becomes clear upon showing \(\langle r\rvert G_0^\pm\rvert r'\rangle = -\frac{1}{4\pi}\frac{\exp(\pm ik\lvert r-r'\rvert)}{\lvert r-r'\rvert}\) with \(k=\sqrt E\) (11), where \(G_0^+\) and \(G_0^-\) describe outgoing and incoming spherical waves, respectively. We use only the “+” form of the propagators and omit the superscript.

The Lippmann–Schwinger equation can be solved formally if the transition operator \(T\) is introduced by \(V\lvert \psi \rangle = T\lvert \phi \rangle\) (12). Defining the propagator of the whole system as \(G(E)=(E-H_0-V+i\eta)^{-1}=([G_0]^{-1}-V)^{-1}\) (13), the following relationships are deduced from Eq. (12): \(G = G_0 + G_0\,T\,G_0 = G_0 + G_0\,V\,G\) (14) and \(T = V + V\,G_0\,T = V + V\,G\,V\) (15). Since \(V=\sum_i v_i\) and the potentials are non-overlapping, the transition operators of individual atoms can be written as \(t_i = v_i + v_i\,G_0\,t_i\) (16).## Dyson’s Expansion

As a series in \(v_i\) and \(t_i\) (Dyson’s expansion [9]):  
\(G = G_0 + \sum_i G_0\,v_i\,G_0 + \sum_{i,i_1} G_0\,v_{i_1}\,G_0\,v_i\,G_0 + \dots\) (17)  
can be rewritten using \(t_i\) as  
\(G = G_0 + \sum_i G_0\,t_i\,G_0 + \sum_{i\neq i_1} G_0\,t_{i_1}\,G_0\,t_i\,G_0 + \dots\)  
and the \(T\)-operator expands as  
\(T = \sum_i t_i + \sum_{i\neq i_1} t_{i_1}\,G_0\,t_i + \sum_{i\neq i_1\neq i_2} t_{i_2}\,G_0\,t_{i_1}\,G_0\,t_i + \dots\) (18)  
with  
\(t_i = v_i + v_i\,G_0\,v_i + v_i\,G_0\,v_i\,G_0\,v_i + \dots\) (19).  

Let us first try to understand these equations. Propagation of a particle—as described by \(G\) in Eq. (17)—consists of a series of scattering events. The first term \(G_0\) describes an unscattered wave, while the second term \(\sum_i G_0\,v_i\,G_0\) represents free propagation \(G_0\) to the \(i\)th atom, a single scattering by \(v_i\), and further propagation (Fig. 4a, left). The next terms “scatter” the wave twice (Fig. 4a, middle and right), and so on.  

Similarly, from Eq. (18) and Fig. 4b one infers that the wave can scatter on atom \(i\), then on atom \(i_1\), etc. Note that successive scattering from the same centre does not occur in \(T\), because each \(t_i\) already sums all orders of scattering on \(v_i\) alone (see Fig. 5): while the electron propagates in the potential of atom \(i\), it may scatter infinitely many times off \(v_i\). In the case of strong scattering these expansions may not converge for photoelectron states, yet the physical picture remains valid—large electron wavelengths prevent decomposing the process into isolated scatterings by individual atoms or groups.

Despite the elegance of operator algebra, practical calculations require computing matrix elements of these operators.  

## Matrix Representation in Angular-Momentum Basis

In the angular-momentum representation [2,12,13], one defines  
\[
G^{jj'}_{LL'} = \langle L,j;k \mid G_0 \mid L',j';k \rangle \,(1 - \delta_{jj'})\quad(20)
\]
\[
t^{jj'}_{i,LL'} = \langle L,j;k \mid t_i \mid L',j';k \rangle \,\delta_{ij}\,\delta_{ij'}\quad(21)
\]
where \(j,j'\) (and \(i\)) label atoms, \(L=(l,m)\), \(L'=(l',m')\) are angular-momentum indices, and \(k=\sqrt{E}\) is the incident‐wave number. Here \(G^{jj'}_{LL'}\) describes how a partial wave of momentum \(L'\) at atom \(j'\) propagates to momentum \(L\) at atom \(j\), with the factor \((1-\delta_{jj'})\) excluding immediate self‐scattering.

With \(T = \sum_i t_i\), the propagator matrix becomes  
\[
G = G_0 + G_0\,T\,G_0 + G_0\,T\,G_0\,T\,G_0 + \dots\quad(22)
\]
which is the geometric series yielding  
\[
G = (1 - G_0\,T)^{-1}\,G_0\quad(23).
\]

## 3.2 Even More About Photoabsorption Cross-Section

Let the total Hamiltonian be \(H = H_0 + V\) and \(G(E) = 1/(E - H + i\eta)\). Inserting a complete set of eigenstates gives  
\[
G(E) = \sum_f \frac{\lvert f\rangle\langle f\rvert}{E - E_f + i\eta}\quad(24).
\]
Using this in the photoabsorption cross-section formula and the identity  
\(\displaystyle \lim_{\epsilon\to0}\frac{1}{\omega\pm i\epsilon} = \mathcal{P}\frac{1}{\omega}\mp i\pi\,\delta(\omega)\) (25),  
one obtains  
\[
\sigma = \sum_f \lvert\langle f|D|i\rangle\rvert^2 \,\delta(E_i - E_f + \omega)
= \sum_f \langle i|D^\dagger \,\delta(E_i - H + \omega)\lvert f\rangle 
       \langle f\rvert\delta(E_i - H + \omega)\,D\lvert i\rangle\quad(26),
\]
which leads to  
\[
\sigma = -\frac{1}{\pi}\,\langle i|D^\dagger\,\Im G(E_i + \omega)\,D|i\rangle\,
         \theta(E_i + \omega - \mu)\quad(27).
\]
The step function \(\theta(E_i + \omega - \mu)\) ensures only excitations above the chemical potential \(\mu\) contribute, as appropriate for light absorption.

The \(r\)-representation of the state \(\lvert L,i;k\rangle\) is  
\(\langle r\mid L,i;k\rangle = i^l\,j_l\bigl(k\lvert r - R_i\rvert\bigr)\,Y_{l,m}(r - R_i)\),  
where \(R_i\) is the position of atom \(i\), \(Y_{l,m}\) are spherical harmonics, and \(j_l\) is the spherical Bessel function of order \(l\).In some cases, the wave functions ⟨r|i⟩ and ⟨r|f⟩ can be determined from electronic‐structure calculations and then used directly to obtain σ through Eq. (1). For example, in band‐structure calculations in crystals, the eigenstates and eigenvalues of the complete Hamiltonian H can be obtained using either Bloch and Wannier functions or by means of the tight‐binding (LCAO) methods. In that case, the state vectors |i⟩ and |f⟩ represent the stationary solutions of electrons moving in a periodic potential.

Conversely, the problem can be solved using the multiple‐scattering (MS) theory. At first we note that the complete set of eigenstates |f⟩ can be chosen to correspond to the atomic eigenstates. We imagine that if other atoms are brought to the vicinity of the excited atom, the local electron density around the absorbing atom is affected by the scattering of the photoelectron’s wave function on the neighbouring potentials. The backscattered electron wave changes the particle density around the central atom. To be precise: in almost exactly the same way as in Eq. (27) it can be shown that the final density of states is equal to  
n(E) = ∑_f ⟨f|δ(E – H)|f⟩ = –1/π Im G(E) (28)  

Since, as can be seen from Eq. (14), the total Green’s function G consists of the free propagator G₀ and the term describing the propagation of the scattered wave, the total density of states can also be divided into the “atomic” part, n₀, and the change due to the scattering, n_scat,  
n(E) = n₀(E) + n_scat(E) (29)  

It is now clear that the density of final states is changed because of the presence of the scatterers. Thus, we are able to reinterpret the behaviour of our physical system: the solutions can be understood either as stationary solutions of the complete Hamiltonian or as solutions that are changed by the multiple scattering from surrounding atoms. For instance, in an N₂ molecule, the photoelectrons can get trapped to a virtual bound state of the molecule (“shape‐resonance”), as seen through the eyes of molecular physics; this can also be understood as strong scattering between two nitrogen atoms.

So far, we have said almost nothing about the strong scattering which occurs when the kinetic energy of the knocked‐out electron is small. The expansion (17), needed in the cross‐section formula [Eq. (27)], converges if the matrix norm ∥G T∥ is less than one, which is usually true for the energies in the EXAFS region. In the XANES regime, however, this is not the case and the series diverges. Despite that, the solution can still be found for a small cluster of atoms if Eq. (23) is used; the matrix inverse must be calculated in that case. The formal procedure that led us to Eq. (23) consisted of disassembling an expression to a series and then assembling it back to a compact form. Eq. (23) therefore holds for the case of strong scattering as well.

The dimensions of the G and t_i matrices depend on the number of scatterers included in the calculation. The cluster size must be relatively small (a few hundred atoms at most) if the size of the matrices is to be manageable. But is this restriction to a small cluster really reasonable and does it give any useful results? The answer is yes, fortunately. Solving the problem for a small cluster of atoms can be used even for a system with a macroscopic number of particles: contributions from successive scattering weaken because of the 1/r dependence of the scattered wave’s amplitude. And most importantly, the mean‐free‐path of the electron, λ(E), is finite, so that the electron can only “probe” inside a region of diameter of approximately 2λ around the absorbing atom.

In present‐day calculations, Mattheiss’s prescription is used to construct scattering potentials: the potentials are spherically averaged (t_i^{jj′LL′} ∝ δ_{LL′}) and the muffin‐tin radii are determined self‐consistently. At the end of this section let us emphasize that the importance of the MS approach was realized quite early: in solid‐state physics this formalism is known as the Korringa–Kohn–Rostoker method.

## Example: Zn
In the XANES regime, the photoelectrons populate unoccupied states above the chemical potential μ. Since—because of the scattered wave—the density of the final states changes, and along with it the charge density, the shape of the absorption edge of the same element is different in different chemical environments. Also, the electron binding (i.e., ionisation) energies change.Diethyl zinc and zinc monatomic vapour spectra are shown. Zn vapour is an exceptional case among the shown spectra. While its shape cannot be explained by means of the MS theory, it can be decomposed into contributions of separate excitation channels [17, 18], the shape of which is well known. It has therefore been added for completeness. At first we note that the apparent positions of the edges are shifted relative to one another. Moreover, the pre-edge resonance that is attributed to the 1s → 4p transition in the case of the atomic spectrum [19] becomes a broader and lower quasi-atomic resonance (an altered bound state) in Zn–et₂, whereas in Zn metal and Zn oxide this spectral feature cannot be discerned. Further differences between individual species are also apparent.

An electron of low kinetic energy is scattered strongly—and possibly many times—by the neighbouring atoms (MS to infinite order is used to describe this process; see Eq. (23)). In contrast with single scattering, which prevails in the high-energy region, multiple scattering depends strongly on angles between scatterers and is thus very sensitive to the local environment of the absorbing atom [8].

With the muffin-tin approximation and with use of the Mattheiss prescription mentioned in the previous section, a serious approximation is made. For example, if the potential in the interstitial region oscillates considerably around its mean value, the error made by replacing the real potential with a constant one could be enormous. The goal is therefore to have the interstitial region as small as possible [8], since it is here that the crude approximation is made.

The difference between the measured and calculated ZnO spectra is shown. The general agreement of the two spectra is quite good, but for detailed quantitative analysis the muffin-tin approximation has to be improved (or bypassed). A few successful solutions have been proposed, e.g., the use of the finite-difference method in the interstitial region [20]. Nevertheless, the shape of the XANES spectra seems to depend primarily on the structure of matter and less on the detailed properties of the potentials [8]. Furthermore, precise calculations require substantial computing power. For example, even with the spherically symmetrized muffin-tin potentials (obtained by the Mattheiss prescription), the calculation of the ZnO XANES spectrum for a cluster of about 180 atoms took more than 10 hours on a 350 MHz PC Pentium II using the FEFF 8.0 code [12].

## Conclusion
We have seen that the information buried in the near-edge region of absorption spectra is already quite well understood: XANES analysis can give details about the electronic structure and the local arrangement of atoms around the absorbing atom. XANES studies are therefore a powerful and promising tool for determining the local structure of various chemical samples.

A very important part of this seminar was to illuminate the approach to near-edge processes by the MS technique. Such a “local” treatment of scattering within a small cluster of atoms can be used to explain the local chemical environment and local density of states. It is thus suitable for studying amorphous materials, such as glasses or gels, as well as crystalline matter, where other techniques have also been developed.

Further attempts are being made to bring XANES analysis to a more quantitative level. The first steps in this direction involve relaxing the muffin-tin constraints, and the next steps may be even more sophisticated (e.g., taking account of correlation effects between electrons to go beyond the one-electron approximation).