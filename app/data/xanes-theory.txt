XANES spectroscopy

Introduction
Especially in the last decades, x-ray absorption spectrometry has gained much of its reputation of being a powerful analytical and research tool, mostly due to the use of synchrotron radiation sources. In this kind of spectrometry, interactions of photons with matter are studied by measuring the photoabsorption cross-section. For incident light with polarisation ˆ and frequency ω the cross section is given by the Fermi's golden rule [1,2]
where |i , |f , E i , and E f denote the initial and final states and their energies; k stands for the wave vector of the incident beam. Only the dipole contribution to the total cross-section has been considered in Eq. (1). By exciting an atom using an x-ray source, the electron configuration of the atom is changed; one (usually a core-shell) electron or more electrons populate unoccupied bound or continuum states. The success of this spectrometry lies in the fact that the photoelectrons act as very sensitive probes that can "feel" the charge distribution and the arrangement of the neighbouring atoms around the absorbing atom, or, with other words, they can feel the arrangement of the neighbouring atoms (chemical environment). When the photon energy is large enough, the photoeffect in one of the core shells can occur. This results in the steplike shape of the absorption spectrum: the increased photoabsorption cross-section due to the knocking-out of an electron is called absorption edge (Fig. 1). We shall see in the next section that one way of understanding this excitation process in a bound atom is describing it by means of multiple scattering: the photoelectron's wave is scattered on atoms surrounding the absorbing atom (Fig. 2). The cross-section of a bound atom therefore depends on the positions and types of the neighbours and is different from that of an isolated atom.  When the photon energy ω is low, the photoelectrons can populate either unoccupied bound states or low-lying continuum states. This part of the spectrum (Fig. 1) is called the XANES region; the acronym stands for X-ray Absorption Near-Edge Structure. On its high-energy end, XANES extends up to Extended X-ray Absorption Fine Structure [3,4,5,6,7], EXAFS in short, where the photoelectron kinetic energy is high. The limiting energy that divides XANES from EXAFS is by no means exactly defined since the transition from the one regime to the other is smooth: as ω is increased, the transition starts happening gradually. As a rule of thumb, near-edge structure ends approximately where the electron wavelength equals the distance from the absorbing atom to its nearest neighbours [8], which usually means about 40-50 eV above the edge. In the XANES regime, the electron's kinetic energy is small and the scattering on the neighbouring atoms tends to be strong for this reason, while the effect of the scatterers becomes smaller at higher energies; in EXAFS region, the photoelectrons are only weakly scattered. The underlying theory is the same in both cases, but complications arise at low energies because the "usual" Born-like scattering expansion is divergent.
3 The theory of XANES

Multiple scattering formalism
In this section we discuss scattering from potentials v i of several atoms or ions, each of which makes a non-zero contribution only within a spherically non-overlapping scattering region of finite radius (Fig. 3),
Outside the spherical regions -in the interstitial region -the potential is set to zero. This Figure 3: The muffin-tin potential consists of non-overlapping spherical regions.
approximation is often used when describing condensed materials and is known as the muffintin approximation. The scattering parameters of each of the scatterers, i. e., the scattering amplitudes and phase shifts, are determined separately for each scatterer and are therefore pure atomic quantities. Propagation of a photoelectron in such muffin-tin potential V is described by the Hamiltonian
where H 0 is the kinetic-energy operator. One is seeking the stationary solution |ψ with the energy E, H|ψ = E|ψ , (
which can be twisted around a little bit to yield
Writing Eq. (3) in this way suggests treating the term V |ψ as a source and solving the "inhomogeneous" Eq. ( 5) by means of the Green's functions: we pretend that the right-hand side of Eq. ( 5) represents the inhomogeneity. To be more specific, if r|φ is the solution of the "homogeneous" part of Eq. ( 5) (E -H 0 ) r|φ = 0 (6) and the free-electron Green's function G 0 is defined with relation
then the general solution of Eq. ( 5) is given as a sum of the solution of the "homogeneous" equation and the particular solution [9,10]
If the photoelectron is only weakly scattered by the potential V , the solution r|ψ is close to the free-electron solution r|φ . Furthermore, when V is identically zero everywhere, the exact equality r|ψ = r|φ holds, as expected. It is apparent from Eqs. ( 4) and ( 6) that we are only looking for solutions of the total Hamiltonian |ψ that have the same energy as |φ which means we are only considering elastic scattering. The formal solution of the operator equation ( 5) is given by the Lippman-Schwinger equation [9,10,11],
Because of its singularity, the operator 1/(E -H 0 ) has been modified by an imaginary term in the denominator, ±iη, where η is infinitesimally small and positive, η → 0 + . The form of Eq. ( 9) reminds us immediately of Eq. ( 8). In fact, the comparison of both equations reveals that
which becomes clear after inserting a complete system d 3 r |r r | into Eq. ( 9). So, what is the meaning of the superscript "±"? It can be shown (see ref. [10]) that
where k = √ E. Obviously, G + 0 and G - 0 describe how outgoing and incoming spherical waves propagate in free space, respectively. Through the rest of the paper we shall use only the "+" form of the propagators so the superscript will be omitted. The Lippman-Schwinger equation can be solved formally if the transition operator T is introduced [9,10,11],
If we define the propagator G of the whole system as
the following important relationships can be deduced from Eq. ( 12) [9,10]:
and
Remembering that V = i v i and that the potentials are non-overlapping, we can write the transition operators of individual atoms as
The physical meaning of the operators T and t i is not obvious yet, but we will try to explain it by means of the "weak-scattering" expansions. When the scattering is weak, i. e., the photoelectron's path is not strongly affected by the potentials v i , equations ( 14)-( 16) can be written as series in v i and t i (Dyson's expansion [9]):
Let us first try to understand those last equations. Propagation of a particle -as described by G in Eq. ( 17) -consists of a series of terms which represent the order of the scattering process. The first term describes how an unscattered wave propagates, while the second term describes free propagation G 0 to the ith atom where the wave is scattered once by its potential v i and then heads forward again (Fig. 4a, left). In the same way, the third term "scatters" the incident wave two times (Fig. 4a, middle and right), etc. Similarly, the meaning of the T -operator can be inferred from Eq. ( 18) and with the help of Fig. 4b: the propagating wave can be scattered on the ith atom, on the ith atom and on the i 1 th atom, etc. Note also that according to Eq. ( 18) successive scattering from the same centre cannot occur. This is because t i already accounts for scattering from v i to arbitrary order (Fig. 5). The operator t i is made up of terms describing
scattering on the potential v i alone: while the electron-wave propagates in the potential of the ith atom, it can, in principle, be scattered infinitely many times. Though in the case of strong scattering the expansions ( 17)- (19) do not converge when applied to state vectors describing the photoelectron wave, the physical interpretation remains the same. In this case, however -because of the large wavelength of the photoelectron with respect to the nearest neighbour distance -the whole scattering process cannot be decomposed to separate scattering events from different atoms or groups of atoms.
Despite descriptive and elegant formulation with the operator algebra, one cannot avoid computing the matrix elements belonging to different operators when performing "real" calculations. Nevertheless, the operators t i and G can be cast into matrix form quite nicely using the angular-momentum representation [2,12,13]
Indices j, j and i are used to denote the atoms and L and L are the angular momenta (l, m) and (l , m ), respectively; k = √ E is the wave number of the incident wave. 1 For example, G jj LL describes how the partial wave with angular momentum L "transforms" to L when it propagates from j th to jth atom. The factor (1 -δ jj ) has been added in Eq. ( 20) to exclude consecutive scatterings from the same scatterer. With definitions ( 20) and ( 21), the propagator matrix G can be written as
where T = i t i and the multiplications used are simply matrix multiplications. This last expression is a geometric series for

Even more about photoabsorption cross-section
Armed with the multiple scattering (MS) formalism, we are ready to proceed to the next problem.
Let H be the total Hamiltonian H = H 0 + V and G(E) = 1/(E -H + iη) the Green's function that describes the propagation of the whole system. By inserting an arbitrary complete set of eigenstates, we obtain
The expression for photoabsorption cross-section [Eq. (1)] can be simplified further if we use Eq. ( 24) and the identity (P is the Cauchy's principal value)
the cross-section formula can be rewritten as
which gives us
Since we are interested in the absorption of light, the step function θ(E i + ω -µ) has been added to assert that only excitations to free states above the chemical potential µ are considered.
In some cases, the wave functions r|i and r|f can be determined from electronic-structure calculations and then used directly to obtain σ through Eq. (1). For example, in band structure calculations in crystals, the eigenstates and eigenvalues of the complete Hamiltonian H can be obtained using either Bloch and Wannier functions or by means of the tight-binding (LCAO) methods [8,14]. In that case, the state vectors |i and |f represent the stationary solutions of electrons moving in a periodic potential.
Conversely, the problem can be solved using the MS theory. At first we note that the complete set of eigenstates |f can be chosen to correspond to the atomic eigenstates. 2 We imagine that if other atoms are brought to the vicinity of the excited atom, the local electron density around the absorbing atom is affected by the scattering of the photoelectron's wave function on the neighbouring potentials. The backscattered electron wave changes the particle density around the central atom. 3 To be precise: in almost exactly the same way as in Eq. ( 27) it can be shown that the final density of states is equal to
Since, as can be seen from Eq. ( 14), the total Green's function G consists of the free propagator G 0 and the term describing the propagation of the scattered wave, the total density of states can also be divided into the "atomic" part, n 0 , and the change due to the scattering, n scat ,
It is now clear that the density of final states is changed because of the presence of the scatterers. Thus, we are able to reinterpret the behaviour of our physical system: the solutions can be understood either as stationary solutions of the complete Hamiltonian or as solutions that are changed by the multiple scattering from surrounding atoms. For instance, in an N 2 molecule, the photoelectrons can get trapped to a virtual bound state of the molecule ("shape-resonance"), as seen through the eyes of molecular physics. Also, this can be understood as a strong scattering between two nitrogen atoms.
So far, we have said almost nothing about the strong scattering which occurs when the kinetic energy of the knocked-out electron is small. The expansion (17), needed in the crosssection formula [Eq. ( 27)], converges if the matrix norm GT is less than one [15], which is usually true for the energies in the EXAFS region. In the XANES regime, however, this is not the case and the series diverges. Despite that, the solution can still be found for a small cluster of atoms if Eq. ( 23) is used; matrix inverse must be calculated in that case. The formal procedure that led us to Eq. ( 23) consisted of disassembling an expression to a series and then assembling it back to a compact form. Eq. ( 23) therefore holds for the case of strong scattering as well [2]. The dimensions of the G and t i matrices depend on the number of scatterers included in the calculation. The cluster size must be relatively small (a few hundred atoms at most [2]) if the size of the matrices is to be manageable. But is this restriction to a small cluster really reasonable and does it give any useful results? The answer is yes, fortunately. Solving the problem for a small cluster of atoms can be used even for a system with a macroscopic number of particles: contributions from successive scattering weakens because of the 1/r dependence of the scattered wave's amplitude. And most importantly, the mean-free-path of the electron, λ(E), is finite, so that the electron can only "probe" inside a region of diameter of approximately 2λ around the absorbing atom. 4In the present-day calculations, Mattheiss prescription is used to construct scattering potentials [2,8]: the potentials are spherically averaged (t i jj LL ∝ δ LL ) and the muffin-tin radii are determined self-consistently. At the end of this section let us emphasize that the importance of MS approach was realized quite early: in solid-state physics, this formalism is known as the Korringa-Kohn-Rostoker method [16].

Example: Zn
In the XANES regime, the photoelectrons populate unoccupied states above the chemical potential µ. Since -because of the scattered wave -the density of the final states changes, and along with it the charge density, the shape of the absorption edge of the same element is different in different chemical environments. Also, the electron binding (i. e., ionisation) energies change  for the same reason, which results in shifting of the absorption edge towards lower or higher energies. As an example, in Fig. 6, the K-edge absorption spectra of zinc oxide, zinc metal, diethyl zinc, and zinc monatomic vapour are shown. Zn vapour is an exceptional case among the shown spectra. While its shape cannot be explained by means of the MS theory, it can be decomposed to contributions of separate excitation channels [17,18], the shape of which is well known. It has therefore been added for completeness. At first we note that the apparent positions of the edges are shifted one to the other. Moreover, the pre-edge resonance that is attributed to the 1s → 4p transition in the case of the atomic spectrum [19] becomes broader and lower quasiatomic resonance (an altered bound state) in Zn-et 2 , whereas in Zn metal and Zn oxide this spectral feature cannot be discerned. Also further on, the differences between individual species are apparent. An electron of low kinetic energy is scattered strongly and possibly many times by the neighbouring atoms [MS to infinite order is used to describe this process -see Eq. ( 23)]. In contrast with single scattering which prevails in the high-energy region, multiple scattering depends strongly on angles between scatterers and is thus very sensitive to local environment of the absorbing atom [8]: Fig. 6 demonstrates strong dependence of the shapes of the spectra on the atoms among which Zn resides.
With the muffin-tin approximation and with use of the Mattheiss prescription we mentioned in the previous section, a serious approximation is made. For example, if the potential in the interstitial region oscillates considerably around its mean value, the error made by replacing the real potential with a constant one could be enormous. The goal is therefore to have the interstitial region as small as possible [8] since it is here where the crude approximation is made. In Fig. 7, the difference between the measured and calculated ZnO spectra are shown. The  general agreement of the two spectra is quite good but for the detailed quantitative analysis, the muffin-tin approximation has to be improved (or bypassed). A few successful solutions have been proposed, e. g., the use of the finite-difference method in the interstitial region [20]. Nevertheless, the shape of the XANES spectra seems to depend primarily on the structure of matter and less on the detailed properties of the potentials [8]. Furthermore, precise calculations require substantial computing power. For example, even with the spherically-symmetrized muffin-tin potentials (obtained by Mattheiss prescription), the calculation of the ZnO XANES spectrum from Fig. 7 for a cluster of about 180 atoms took more than 10 hours on a 350 MHz PC pentium II using the FEFF 8.0 code [12].

Conclusion
We have seen that the information buried in the near-edge region of absorption spectra is understood quite well already: the XANES analysis can give details about the electronic structure and the local arrangement of atoms around the absorbing atom. XANES studies already seem to be a powerful and promising tool for the determination of the local structure of various chemical samples.
A very important part of this seminar was certainly to illuminate the approach to the nearedge processes by the MS technique. Such "local" treatment of the scattering inside a small cluster of atoms can be used to explain the local chemical environment and local density of states and is thus suitable for studying amorphous materials, such as glasses or gels, as well as for crystalline matter, where other techniques have also been developed.
Further attempts are being made to bring XANES analysis to a more quantitative level. The first steps in this direction are relaxing the muffin-tin shackles and the next ones may be even more sophisticated (e. g., taking care of correlation effects between electrons to go beyond one-electron approximation).
