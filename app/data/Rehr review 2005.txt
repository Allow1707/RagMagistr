Progress in the theory and interpretation of XANES

Introduction
Significant progress has been made over the last several years in understanding the X-ray absorption near edge spectra (XANES), i.e. the structure in the spectra within about 30 eV of threshold where scattering is strong and inelastic losses are relatively weak. This progress has occurred in parallel with advances in synchrotron radiation X-ray sources and computer technology. The unprecedented precision now available in modern experimental probes of X-ray absorption spectra (XAS) underscores the need for improved theories for quantitative analysis of experiment. The progress in XANES is a sequel to the dramatic advances in theory of extended X-ray absorption fine structure (EXAFS). The basic theory of EXAFS is now well understood, as discussed in a recent review [1]. Below, we will use the acronym XAS to refer to both EXAFS and XANES since they can be treated within a common theoretical framework. This framework illustrates the close connection between the theory of XAS and excited state electronic structure, since X-ray spectra are 0010-8545/$ -see front matter © 2004 Elsevier B.V. All rights reserved. doi:10.1016/j.ccr.2004.02.014 directly related to a Green's function for the excited photoelectron in the presence of a core-hole. The main purpose of this paper is to discuss recent advances in the theory of XAS based on this connection.
In contrast to the now "standard" density functional theory (DFT) of ground state electronic structure, the theory of excited states is less well understood. Nevertheless, an analogous independent electron theory has emerged, in which the final states are represented as quasi-particles. This approach, which is the basis for much current work, will be referred to as the standard quasi-particle theory of XAS. The theory includes final state effects, such as the core-hole, inelastic losses, and vibrational effects, and replaces the ground state exchange-correlation functional with an energy dependent self-energy. Thus, the approach differs substantially from ground state theories. As a result, conventional band structure and quantum chemistry codes with ground state potentials are not usually appropriate for general XAS calculations, except close to threshold. This is illustrated in Fig. 1, which presents a comparison of the XAS of Cu as calculated using ground state and standard quasi-particle theories, and as measured experimentally. As one can see, the quasi-particle model is in better agreement with experiment at high energies, though discrepancies persist at the edge which require corrections to the quasi-particle theory. Thus, we also discuss recent advances in treating corrections to the quasi-particle approximation, including multiple-electron excitations and the effects of screening of the X-ray field. We also briefly compare a number of approaches for the calculation of XANES. Finally, we discuss how the theory Fig. 1. XANES for K-shell Cu from XAS experiment (dots); from calculations with the FEFF8 code using the standard quasi-particle theory including a plasmon-pole self-energy and a screened core-hole (solid line); and from ground state density functional theory without a core-hole (dashes). Note that ground state theory (without a core-hole) is in reasonable agreement with experiment at the edge, but has too large an amplitude at high energies, where the standard theory is in reasonable agreement. can be used to interpret the XANES in terms of excited state electronic properties of a material and their coordination chemistry.

Standard quasi-particle theory of XAS
The basic independent-particle (i.e. quasi-particle) theory of XAS [1][2][3] has been addressed by many authors. Formally, the contribution to the X-ray-absorption coefficient µ from a given core-state i at a given X-ray energy hω can be calculated using Fermi's Golden rule
(
Here hω + E i ≡ E is the photoelectron energy, d the coupling to the X-ray field, and E i is the (large negative) energy of the core level, and the sum is over unoccupied final states of energy E f . Most practical calculations are based on the reduction of the many-body Golden rule to a one-electron approximation and the dipole-approximation d = ˆ • r. Although the question of precisely which one-electron states to use is not unambiguous, much current work is based on the "final state rule," in which the final states |f are calculated in the presence of an appropriately screened core-hole, and all other many-body effects and inelastic losses are lumped into a complex valued and energy-dependent self-energy or optical potential Σ(E). This standard quasi-particle model is the basis for several XAS codes including FEFF [1], the CONTINUUM code of Natoli et al. [4], and the XANES code of Fujikawa [5]. Within this quasi-particle theory, the final states ψ f are eigenstates of a Dyson equation (i.e. the analog of the Schrödinger equation for excited states)
Here h is the non-Hermitian final state Hamiltonian, V coul is the final state Coulomb potential, where the prime denotes quantities calculated in the presence of the screened core-hole potential, and Σ(E) is the photo-electron self-energy in the quasi-particle approximation.
As noted above, the crucial difference between ground state electronic structure and excited states is the need for Σ(E) and the core-hole for excited states. The self-energy is essentially a dynamically screened exchange interaction, which is the analog of the exchange-correlation potential V xc of ground state density functional theory. Typically, the real part of the self energy, varies by about 10 eV over XAS energies, while the imaginary part is negative and varies by about 5 eV. Thus, this quantity accounts both for (extrinsic) inelastic losses or final-state broadening and systematic shifts in peak positions compared to those calculated with ground state theories.
One of the key developments in practical XAS codes is an efficient algorithm for calculations of Σ(E) based on the GW approximation of Hedin. FEFF and other XAS codes usually use a local density approximation for Σ(E) based on the plasmon-pole dielectric constant; this is often referred to as the Hedin-Lundqvist self-energy. This approximation works well for EXAFS, and is close to the ground state DFT near threshold. However, the plasmon-pole self-energy tends to overestimate losses in the XANES as can be seen in Fig. 1. One of the major challenges at present is to develop better algorithms for calculating Σ(E).
Although the standard quasi-particle theory usually works well, all independent electron theories neglect many-body excitations, e.g. intrinsic losses due to the sudden creation of a core-hole. As a consequence, the standard theory usually overestimates the magnitude of the fine structure in the spectra, typically by about 10%. Moreover, the core-hole potential can be too strong (e.g. in Fig. 1). Second, due to local field effects, screening of the X-ray field can be important, especially for soft X-rays [6]. This screening has been found to be crucial for calculations of transition metal L-shell XAS. These and other corrections are discussed in Section 3 below. Finally, the standard theory is not yet quantitative for strongly correlated systems and for strongly atomic-like systems, where multiplet effects are important [7].

Real space multiple-scattering (RSMS) formalism
An important formal development in XAS theory is the real-space multiple scattering (RSMS) approach. This method is the real-space analog of the KKR band structure method [2,3]. This approach also takes advantage of the close connection between XAS and electronic structure and provides an ab initio method for general calculations of XAS over an extended energy range, even in aperiodic systems.
The calculations of final states in the Golden rule is often a computational bottleneck, and can only be carried out efficiently for highly symmetric systems such as atoms, small molecules, or periodic solids. However, many systems of interest lack symmetry. Also k-space (i.e. band structure) methods [8,9], often ignore the effects of the core-hole and lattice vibrations which spoil crystal translation symmetry, unless a super-cell approximation is also used. Thus, instead of explicitly calculating the final states, it is preferable to re-express the XAS in terms of the photoelectron Green's function or propagator G in real space, which implicitly sums over all final states. Thus, making use of the spectral representation,
the Golden rule can be rewritten as
This formulation turns out to be advantageous for XAS calculations even in perfect crystals, since inelastic losses limit the range probed by XAS experiment to clusters typically of order a few hundred atoms about a given absorption site. This gives rise to a short range order theory. The cluster size is determined largely by the mean-free path, which is controlled by the core-hole and final state lifetimes. Moreover, at high energies, scattering is relatively weak and perturbation theory in the scattering potential converges well. The starting point in MS theory is the separation of the potential into contributions from "scattering potentials" v R localized on each atomic site R
Within MS theory, the propagator G( r , r, E) = L,L R L ( r)G L,L R L ( r ) is separable, so that the expression for µ in Eq. ( 3) can be reduced to a calculation of atomic dipole-matrix elements M L = i|ˆ • r|L and a propagator matrix G L,L (E)
where L = (l, m) denotes the angular momentum variables.
Here and elsewhere we interchangeably use either the photoelectron energy E or the photon frequency ω to characterize the energy variation of the XAS. The relativistic generalization [10] is identical in form, but with relativistic angular momentum variables. Relativity is important for the treatment of spin-orbit effects, which are biggest in the atomic cores, and hence, most important for the transition matrix elements. However, relativity has only weak effects on scattering of non-relativistic electrons. In FEFF, they are treated to high accuracy using a relativistic Dirac-Fock approach [11].
The calculation of the scattering potentials simplifies for electrons even of moderate energy, where the scattering depends strongly on the density in the core of an atom and spherical symmetry is a good approximation. Thus, at high energies self-consistency is not important, and the potentials are well described in terms of an overlapped atom approximation (i.e. the Mattheiss prescription). However, this approximation is inadequate for XANES where self-consistent field (SCF) calculations are almost always necessary. That is, the potentials, electron densities and the Fermi energy are iterated until they are self-consistent. A reason for this is that the atomic electronic configurations usually differ substantially from those in solids due to hybridization and chemical bonding. In the FEFF8 code, SCF potentials are implemented using the spherical or "muffin-tin approximation." However, this approach is adequate to obtain an accurate estimate of the Fermi energy E F and fractional occupations of the various valence states. The Fermi energy defines the threshold for the XANES; in molecules E F is typically midway between the highest occupied and the lowest unoccupied levels. Comparisons with accurate ground state electronic structure codes have verified the adequacy of this algorithm. Nevertheless, muffin-tin corrections can be important within a few eV of threshold, e.g. in anisotropic systems. Due to deviations from spherical symmetry some peaks are split and peak intensities are altered. Thus, the development of efficient full-potential RSMS approaches remains a challenge, which is under active development.
In RSMS theory, the propagator G L,L naturally separates into intra-atomic contributions from the central atom G c and MS contributions from the environment G sc . Thus, G = G 0 + G sc , so that the XAS µ, can be factored as
Hence, the structure in the XAS µ depends both on the atomic background µ 0 and on the fine structure χ due to MS,
, where the scattering contribution to G is given by
where δ are partial-wave phase shifts. These results are consistent with the experimental definition of XAFS χ = (µ -µ 0 )/ µ 0 , where µ 0 is the jump in the atomic background absorption. For XANES, however, the MS expansion must generally be carried to very high or all orders (full MS), e.g. by matrix inversion [12] or Lanczos algorithms (Section 2.2). The matrix G L,L can also be expressed as a sum over all MS paths that a photoelectron can take away from the absorbing atom and back [2], and thus, gives rise to the path expansion, which converges rapidly for EXAFS with of order 10 2 paths. This expansion sometimes converges adequately in XANES, particularly in cases with a short core-hole lifetime such as deep core-hole levels in heavy elements. However, it is not always reliable. The MS series is formally given by
where the successive terms represent single, double, . . . scattering processes.
In general, one needs a combination of full multiple scattering and the path expansion to cover all energies of interest in XAS. Due to the large dimension of G, exact calculations with the path expansion can only be carried out for a few low-order MS paths [13]. To overcome this computational bottleneck, an efficient method based on the Rehr-Albers (RA) scattering matrix formalism [14] has been devised. The RA approach yields curved-wave calculations of the effective scattering amplitude f eff (k) (from which the FEFF code takes its name) in terms of a separable representation of the free propagator G 0 (E). With this representation the MS expansion can be re-expressed as a sum over MS paths R in a form identical to the original EXAFS equation of Sayers et al. [15]
except that all quantities must be redefined to include curved wave and many-body effects implicitly. Usually only a subset of order 10 2 of the most important paths are adequate to represent the observed XAFS to high accuracy. Here k = [2(E -E 0 )] 1/2 is the wavenumber measured from threshold E 0 , λ k ≈ k/(|ImΣ| + Γ/2) is the XAFS mean-free path which is calculated in terms of the self-energy and core-hole lifetime. Finally, σ, which characterizes the thermal and structural disorder, is the rms fluctuation in the effective path length R = R path /2, which corresponds to peaks in the EX-AFS Fourier transform. The effects of thermal and structural disorder are of crucial importance in XAS at high energies, where they lead to a strong damping of the fine structure. This damping is usually dominated by an XAFS Debye-Waller factor exp(-2σ 2 k 2 ), where σ 2 is the correlated mean-square radial vibrational amplitude of the near-neighbor bonds, and varies inversely with the local bond strength. This damping factor is the analog of the Debye-Waller factor encountered in X-ray diffraction exp[-(1/2)k 2 u 2 ]. In XANES, where k is small (a few Å -1 ), the Debye-Waller factor is of order unity, and hence these terms are usually considerably less important. Moreover, we have found that they can be approximated to reasonable accuracy by including a correlated Debye-Waller factor exp(-σ 2 R,R k 2 ) in each propagator G LR,L R . However, there are some cases where structural disorder can lead to additional peaks in the spectra, which are normally forbidden by dipole selection rules. This underscores the utility of real-space codes compared to those based on crystalline periodicity.
Higher moments of the pair distribution function are sometimes important, especially in temperature dependent investigations of XAS. One of the key theoretical developments in XAFS theory is the cumulant expansion which yields an efficient parameterization of such thermal and configurational disorder [16,17] in terms of a few moments or cumulants σ (n) of the pair distribution function. Formally, this gives rise to a complex Debye-Waller factor exp[ n (2ik) n σ (n) /n!] in G sc which contributes both to the amplitude and phase of XAFS. The thermal contributions to σ 2 can often be fit to a correlated Debye model [18]. The corrections depend on anharmonicity. The first cumulant σ (1) is the thermal expansion, while the third σ (3)  characterizes the asymmetry or skew of the pair distribution function. These odd order contributions can strongly affect the phase of the fine structure, especially at high energy, giving a contribution 2kσ (1)
Relations between the cumulants have been derived [19] which show, to leading order in the anharmonicity parameter, that σ (1) ∝ σ (2) (T) and that σ (2) is related to σ (2) (T). The third cumulant is important in bond distance determinations and in interpretations of thermal expansion. If the third cumulant is neglected in the analysis, bond distances obtained from EXAFS often appear unphysically short.
Improved treatments of XAFS Debye-Waller factors have recently been developed which go beyond the correlated Debye approximation [20], and permit fits of Debye-Waller factors to local spring constants. Such treatments are important in highly anisotropic materials such as polymers and biological systems. Another approach is to parameterize the N-particle distribution [21]. Molecular-dynamics approaches are promising [22] as a less phenomenological approach, but accurate ab initio treatments require computationally intensive, total energy calculations and remain a challenge.

Fast parallel, Lanczos XANES calculations
Due to the need for matrix inversion in full MS calculations, which scale in compute time as the cube of system size, XANES calculations are usually more time-consuming than EXAFS where the MS expansion converges typically with of order 10 2 paths. Indeed, full MS calculations become computationally intractable in the EXAFS regime or when (e.g. for low Z atoms) the mean free path is very long. This limitation has slowed attempts to use XANES in practical fitting schemes to extract chemical information in addition to geometric structure. Thus, one of the challenges in XANES theory has been to increase the computational speed. To this end, we have found that modern Lanczos algorithms are quite stable and can substantially improve computational speed [23] of the matrix inversion. The Lanczos algorithm is now incorporated as an option in the most recent version 8.2 of FEFF. An advantage of the Lanczos approach is that it naturally interpolates between the full and finite MS limits. More precisely, the number of Lanczos iterations needed for convergence roughly corresponds to the order of MS terms included in the calculation at a given stage. For Si, for example the number of iterations is found to drop from order 10 2 near threshold to of order 10 around 35 eV above the edge, where the path expansion then converges well. Thus, the approach clarifies how the MS expansion converges with respect to energy and when the path expansion is valid. This difference provides a way to differentiate between EXAFS and XANES, based on the convergence of the MS expansion.
Even more dramatic reductions in computational time can be obtained from parallel algorithms. The time for such algorithms scales as T 0 +T 1 /N, where N is the number of processors, and has been found to provide about two orders of magnitude further improvement [23] in computational speed with of order 10 2 processors. Parallelization has also been implemented in FEFF8 with the message-passing-interface (MPI) protocol [24]. As a result, XANES calculations, even for very large systems of order 10 3 atoms, can now be carried out in about 1 cpu-h on large parallel computers with MPI. This large size is needed for low Z materials like Si, where the mean-free path and core-hole lifetime are relatively large.

Comparison with other approaches
Although we have focused on the RSMS approach here, many other one-particle methods are now used for calculating XANES. Each has its advantages and disadvantages and regions of validity.
Conventional state quantum chemistry codes like GAUS-SIAN [25] and DMOL [26], band structure codes like the full potential LAPW code WIEN2K [27], and plane wave pseudopotential codes like CASTEP [28], PARATEC [29], and VASP [30] are based on ground state density functional theory. Such codes are now well developed and generally give highly accurate treatments of ground state electronic structure, e.g. Coulomb potentials, electron densities, total energies, and electronic densities of states. Many of these ground state codes also make use of parallel computation to improve efficiency. Such codes can also calculate low energy excited state properties, within a few eV of threshold. However, since self-energy effects are neglected, the calculated peak positions and amplitudes tend to deviate systematically from experimental results. To compensate for the self-energy shifts Matterlik et al. [31] found that it necessary to rescale (i.e. stretch) the energy axis of the theory with respect to the threshold by a factor typically about 1.06 to match experimental peak positions. For these reasons, ground state codes are often unsatisfactory for quantitative XANES calculations, even for the systems for which they are designed, i.e. molecules and periodic solids. Moreover, such codes can be inefficient for calculations of XANES. For example band-structure codes make use of detailed Brillouin zone summations to calculate electronic densities of states to very high accuracy, however, many of the fine details of the structure (e.g. van Hove singularities which are not observed) are then washed out by final state broadening.
A significant improvement on pure ground state codes is the inclusion of a static screened core-hole potential, especially for the K-shell of insulators. This core-hole effect can be included in band-structure codes, e.g. with a super-cell approach and large units cells of order 10 2 atoms. This yields an approximation analogous to the final state rule. For example pseudopotential codes based on this approach have yielded XANES in reasonable agreement with experiment [32]. The quantum chemistry code STOBE [33] uses a local orbital approach and a transition-state approximation to the core-hole potential. Further improvements, such as the addition of GW self energies, should increase the utility of these codes for excited state calculations. Efforts along these lines are now being made, e.g. with the PARATEC code [29].
By comparison, the RSMS approach method has several advantages for XAS calculations, since it includes the final state effects of the self-energy and the core-hole. Moreover, the method provides a relativistic all-electron real-space approach which is applicable over a wide energy range from threshold up to over 1 keV. Indeed, the RSMS method is currently the only approach capable of quantitative EX-AFS calculations at high energies. In contrast, due to basis set limitations, most ground state codes are limited to a few tens of eV from threshold. A current drawback of the RSMS method is the reliance on spherical muffin-tin potentials. However, efforts to develop full-potential real space approaches are in progress. For example the real-space approach of Joly et al. [34] uses a finite cartesian grid in real space, however, the method is presently limited to low energies and is not yet self-consistent.

Many-body effects-inelastic losses and local-field effects

Inelastic losses
Theories of inelastic losses in XAS have a long history [35][36][37]. As noted in Section 1, inelastic losses like shake-up and shake-off processes, are crucial to a quantitative theory of XAS amplitudes. For this reason, one of the drawbacks of the standard quasi-particle model is an overestimate of the amplitude of the various XAS peaks, typically by about 10%. This discrepancy can lead to incorrect coordination number determinations in XAS analysis. Correcting this error requires a treatment of inelastic losses that goes beyond the quasi-particle approximation. The reason is that the standard quasi-particle model only includes extrinsic losses, i.e. losses which occur during the propagation of the photoelectron and are caused by the creation of excitations of the system such as plasmons, electron-hole pairs, etc. However, to obtain correct amplitudes one must also take into account intrinsic losses, which refer to the creation of excitations by the sudden creation of the core-hole. Since such excitations are identical to those created by extrinsic losses, they are quantum-mechanically indistinguishable, and hence, inter-ference between extrinsic and intrinsic losses must be considered. As in photoemission spectroscopy, this interference is quite strong near excitation thresholds, where the losses strongly cancel due to the opposite signs of the coupling between the photoelectron and the core-hole to excitations such as plasmons.
Recently, there has been some progress in quantitative calculations of inelastic losses. Below, we briefly review the approach of Campbell et al. [38], which is an extension of the quasi-boson approach introduced by Hedin and Bardyszewski [36,37]. This approach provides a computationally tractable way of treating inelastic losses in solids. Other formulations such as configuration-interaction have been used for atoms and small molecules, but are not yet feasible for extended solids, where the excitations are dominated by collective (e.g. plasmon) excitations. In particular, the results can be formulated in terms of an effective one-particle propagator G eff which includes both inelastic losses and interference effects. This effective propagator contains an asymmetric quasi-particle peak plus a broad energy dependent satellite structure. The approach is essentially a generalization of the GW approximation to the self-energy, but can also account for edge-singularity effects and corrections to the final state rule. Moreover, the approach yields semi-quantitative estimates of the XAFS many-body amplitude factor S 2 0 (ω) which is typically about 0.9, in reasonable agreement with the observed amplitude reduction. As in photoemission, the theory exhibits appreciable cancellation of extrinsic and intrinsic losses near threshold due to interference terms. This cancellation is crucial in quantitative calculations, since the strength of extrinsic satellite excitations from the fast photo-electron alone is expected to be of order 0.3, which is much larger than typical 10% amplitude discrepancies noted above. Thus, the theory also explains the surprising weakness of multi-electron excitations in the observed XAS [1], as well as the validity of the standard quasi-particle model which completely neglects such multi-electron excitations. Physically, the cancellation reflects the opposite signs, and hence, a reduced coupling of the photo-electron and core-hole to plasmon and particle-hole excitations. Finally, at sufficiently high energies the interference contributions become negligible, and the theory crosses over to the sudden-approximation limit given by the standard model.
One of main results of the quasi-boson theory is an expression for the XAS as a convolution of the one-electron XAS µ (1) with an energy dependent spectral function A(ω,ω ) µ(ω) = dω A(ω, ω )µ (1) (ω -ω ) ≡ µ (1) . (10) The shape of the total spectral function A(ω,ω ) typically consists of a sharp primary "quasi-particle" peak of strength Z * ≈ 0.9 and width Im Σ, and a broad satellite. Formally, A is related to an "effective, one electron Green's function," A = (-1/π ) Im G eff which contains both quasi-particle and satellite peaks. The satellite terms characterize the multiple electron and plasmon excitations (e.g. shake-off) in the system. The one-electron XAS µ (1) is similar to that in the Golden rule in Eq. ( 1), except that the dipole operator d → dP contains a projection operator P onto unoccupied states. This operator prevents spurious transitions to occupied states in the standard model, and can be shown to account for weak edge singularity effects close to the edge.
The quasi-boson (oscillator) model Hamiltonian is similar to that introduced in Ref. [36] for photoemission. The essence of the model is that the electron-hole type excitations are represented by bosons a n with energies ω n , and the electron-charge fluctuation couplings are represented by terms linear in the boson operators. These coupling terms V n are labeled by an index n. They are termed fluctuation potentials and can be determined from an RPA type dielectric function.
The key result, obtained by an expansion to second order in the coupling functions V n , is an expression for the effective propagator G eff which includes, respectively, the extrinsic and intrinsic losses and (with a minus sign) interference terms
Here the terms in ω n give rise to the satellite excitations. The functions G(ω) ≡ Z[ω -h -(ω) + iγ] -1 are damped Green's function calculated in the presence of a core-hole potential; they are equivalent to those in the standard quasi-particle model except for a renormalization constant Z of order exp(-a), where a ≈ 0.3 characterizes the dimensionless strength of the satellites. The above expression yields an expression for the spectral function A(ω,ω )and hence the XAS µ(ω) as an expansion in damped one-particle Green's functions. The approach, thus, avoids the calculation of correlated many-body final states using CI or other methods. Moreover, it is efficient since details in the shape of A are not essential, as they are averaged over in the convolution. The various contributions to the A can be represented as a sum of quasi-particle and satellite terms
Here A qp represents the sharp quasi-particle peak and A sat (ω, ω ) = A extr (ω, ω ) + A intr (ω, ω ) -2A sat inter (ω, ω ) comes from the extrinsic and intrinsic satellites and tend to be suppressed by the interference satellites. Near threshold the net weight of each of the contributions A extr , A sat inter , and A intr is equal to the strength parameter a, and their shapes are similar, so that the sum of all of these contributions tend to cancel, thus, suppressing multi-electron excitations. Also near threshold the interference contribution to the quasi-particle peak a(ω) ≈ a. These results imply that the net strength of the main quasi-particle peak becomes nearly unity at threshold, Z exp(-a)(1 + 2a) → 1 + O(a 2 ) and hence, the standard quasi-particle model is recovered close to threshold.
It is interesting to examine how the extrinsic and intrinsic losses and interference affect XAFS. Since the fine structure χ (1) (ω) is rapidly varying and energy dependent, the effect of a convolution µ (1) = µ 0 [1+ χ (1) ] over a (normalized, positive) spectral function Ãeff (ω, ω ) is a decreased and phase-shifted XAFS amplitude. The effect on each multiple scattering path of length R can be expressed as a "phasor sum" over the effective spectral function analogous to that derived using the sudden approximation [35]
Qualitatively, the many-body amplitude reduction factor S 2 0 (ω, R) is weakly energy dependent, and reduces to unity (the quasi-particle limit) at low energies where interference is complete. Over a wide range, S 2 0 (ω, R) is roughly constant near about 0.9 and then smoothly increases toward unity at very high energies. As a result, various independent particle theories can be corrected for multiple-electron excitations using the quasi-boson approximation for the spectral function. As shown by Campbell et al. [38], the convolution also tends to correct for the discrepancy between experiment and theory based on the standard quasi-particle model (Fig. 1) close to the edge.

Local field effects in XAS
Although the standard quasi-particle model, is generally successful in describing XANES, it can sometimes fail near soft X-ray edges. A glaring example is the L 2,3 edges of 3d transition metals [39][40][41]. For these materials, the independent electron approximation predicts an L 3 /L 2 transition intensity "branching ratio" near 2:1, while the observed ratio varies considerably with atomic number Z, and is closer to 1:1 for metals like Ti and V. The trends in this behavior have been calculated using atomic models, e.g. configuration-interaction and multiplet codes. An efficient alternative approach for treating the problem is the time-dependent local density approximation (TDLDA) [6]. In this approach, the Coulomb interaction naturally mixes different many-body particle-hole states, leading to a shift of oscillator strength from the L 3 to the L 2 . The physics of this mixing is similar in the CI and multiplet treatments. The TDLDA approach also yields a physical interpretation of these many-body effects in terms of screening of X-ray field as discussed below.
The TDLDA [6,[41][42][43] provides an efficient formalism for calculations of response functions within the local density approximation. This approach was originally introduced for atoms [6], but has since been extended to many other systems [41]. The TDLDA equations are analogous to Bethe-Salpeter equation (BSE) [44][45][46], which provides a systematic many-body framework for treating particle-hole interactions in XANES. The main difference between the TDLDA and the BSE lies in the form of the interaction kernel, K. The TDLDA uses a local exchange-correlation contribution f xc based on density functional theory for the direct terms, while the BSE uses the non-local screened Coulomb interaction W which gives an improved treatment of the screened core-hole potential. Here we will focus on the TDLDA approach.
Within the TDLDA, the XAS (or cross-section) µ(ω)can be expressed as an integral over the non-interacting response function χ 0 ( r, r , ω) and the screened X-ray field φ( r, ω). Then the XAS can be written as
This expression for the XAS µ in the TDLDA is equivalent to an analogous expression with d replaced by the external X-ray field d and χ 0 by the full response function χ = [1-χ 0 K] -1 χ 0 (ω) [6]. Here f i are Fermi occupation numbers (1 or 0), and the sums run over all one-electron eigenstates ψ i ( r) of the ground state Hamiltonian. The screened dipole coupling d(ω) consists of the external field d (in the dipole approximation) plus an induced local field, which in matrix form is given by
Here the interaction kernel K( r, r , ω) = V( r, r ) + f xc ( r, r , ω) denotes the particle-hole interaction (or TDLDA kernel), which contains direct and exchange parts, and V = 1/| r -r | is the Coulomb interaction. This TDLDA approach formalism fits well with the RSMS formalism used in FEFF8. In particular, the screening of both the X-ray field and the core-hole interaction only affects the particle-hole states and can be included implicitly in terms of renormalized dipole matrix elements. Otherwise the expression and hence the XAFS is unchanged. Thus, the XAS can be re-expressed as
where MiL (ω) = R L | d|i . The implementation of the TDLDA approach evidently requires an adequate treatment of the exchange-correlation functional f xc (ω), which is much less well understood than the ground state functional. We have found that calculations of dynamical screening can be avoided for L 2,3 XAS by using a simplified dynamic TDLDA model, based on the BSE [47]. This approximation yields good agreement with experiment for the L 2,3 XAS of 3d transition metals, and also for the large blue-shifts observed in some soft X-ray spectra [47].

Quantitative interpretation of XAS
In independent developments, robust EXAFS analysis procedures have been developed based on the high-order MS path approach, as briefly reviewed in Ref. [1]. These procedures are now being used extensively to extract information concerning the coordination chemistry of materials. An illustrative set of examples is the coordination chemistry of minerals [48]. Some effort has also gone into the interpretation of XANES data. However, the quantitative analysis of XANES is still not well developed. In particular, there is also a need for a reliable inverse-method of extracting chemical and geometrical structure from XANES, due to significant MS corrections. On the other hand, there has been significant recent progress [49,50] which shows that significant geometrical information can be obtained from XANES alone using in analogy with EXAFS analysis. Moreover, the XANES signal also depends sensitively on the point-group symmetry of the absorbing atom due to the dependence of the strong MS terms on symmetry. In addition, the shape of the XANES directly reflects the excited state electronic densities of states in a material. The reason is that the local projected density of states (LDOS) ρ has a form analogous to XAFS, i.e.
where E is the photoelectron energy, so that both share similar fine structure. As a result, one can deduce from experimental XAS measurements the unoccupied LDOS ρ(E) as
where the factor γ(E) = ρ 0 (E)/µ 0 (E) is a smooth, atomic ratio, which includes the effects of the core-hole interaction in µ 0 . Peaks in the LDOS [51,52] at low energy correspond to transitions between different molecular-orbital (MO). However, at higher energies the MO picture becomes more difficult to apply [53]. This and analogous relations have recently been exploited to interpret charge counts from XANES, e.g. in transition-metal oxides [53] and also spinand orbital-moments from XMCD [54].
As an example, we show in Fig. 2, the XANES for the metal oxide CaO as calculated from FEFF8 (solid line) and experiment (dashes). The comparison with no adjustable parameters is semi-quantitative, and is typical of results that can currently be obtained for K-shell XAS. The comparison also shows that additional broadening (e.g. to account for experimental resolution) should improve the agreement of peak amplitudes. We also show in Fig. 2, the local pDOS of the Ca atom with the core-hole. The pDOS has been shifted vertically for clarity; the abscissa has been shifted by the threshold energy E 0 = 4051.8 eV for comparison with the X-ray energy hω. Calculations without a core-hole, e.g. from conventional band-structure codes, have a much smaller main peak and give much poorer agreement. Improvements in the edge shape will likely require non-spherical corrections and improved treatments of the self-energy and inelastic losses.
The SCF calculations also determine the fractional occupations of the various angular momentum states above the core levels. For the Ca atoms, one finds a solid state configuration of s 0.31 p 0.44 d 0.89 , i.e. with a net charge of +0.37, in contrast to an atomic configuration of s 2 . For the O atoms, the configuration is s 1.85 p 4.48 d 0.036 with a net charge of -0.37. These results show that the charge transfer to the O and Ca atoms is proportional to their valence, i.e. ±2 with a factor of about 0.2. The configuration of the Ca with the core-hole is s 0.36 p 0.54 d 1.54 , with a net charge of +0.44, showing that there is approximately one additional charge on the absorbing Ca atom which screens the core-hole. Similar factors have been observed in other cases as well, though it is not clear that this is a general rule.

Applications to X-ray spectroscopies
The RSMS formalism outlined above has been incorporated in various XANES codes. For example the implementation in FEFF8 permits self-consistent calculations of both XAS and electronic structure. This code has already been applied extensively [1]. Tests show that this approach (without a core-hole) can also calculate LDOS and hence ground state electronic structure in good agreement with full-potential band-structure codes such as WIEN2K. The FEFF8 code is also highly automated and "user friendly," requiring a minimum of input and few adjustable parameters.
Because the underlying physics is similar, the same RSMS approach can be applied to many other spectro-scopies, e.g. electron energy loss spectra (EELS) [55,56], diffraction anomalous fine structure (DAFS), and the X-ray elastic scattering amplitude (XS) [57]. In this latter application, both real and imaginary parts of the anomalous X-ray scattering amplitude are calculated simultaneously in the complex energy plane, without the necessity of a Kramers-Kronig transform. The presence of XAFS gives rise to significant solid-state contributions in the anomalous scattering amplitudes, which are ignored in the standard tables [58]. The approach includes dipole-quadrupole and quadrupole couplings, and thus, also permits calculations of X-ray natural circular dichroism (XNCD) and the X-ray anomalous cross scattering amplitude (XACS), which are both due to solid state effects. Similarly, calculations of X-ray magnetic circular dichroism (XMCD) have be carried out [59]. The XMCD for the K-shell emphasize the importance of spin-orbit relativistic effects in the final state. RSMS techniques have also been used for photoelectron diffraction (PD) [60]. Many of these specialized applications are not yet highly automated. However, the latest FEFF codes have been modularized to simplify both the automation and extensions to various spectroscopies and analysis tools as they are developed.

Conclusions
Codes based on RSMS theory now make possible a general treatment of XAS, encompassing XANES and EXAFS, as well as a number of other X-ray spectroscopies. The availability of a quantitative theory is key to an interpretation of the spectra in terms of local geometrical structure and electronic structure. The current state of XAFS is now highly quantitative and widely used. With reasonable estimates of the many-body amplitude factor, the error in fine structure amplitudes is usually less than 10%. With recent developments in algorithms and calculational speed, quantitative calculations and fits are rapidly becoming possible in XANES as well, although the agreement is still only semi-quantitative in many cases. Improved treatments of the self-energy, inelastic losses, and core-hole effects are clearly desirable. Also, efficient approaches for treating many-body corrections such as local field effects and inelastic losses have been developed, although these are not yet incorporated into widely available codes. Thus, XANES is beginning to realize its promise as a quantitative tool for elucidating both the coordination chemistry and electronic structure in materials.
RR 01209, and was facilitated by the DOE Computational Materials Sciences Network.
