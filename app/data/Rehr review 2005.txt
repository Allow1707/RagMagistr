## Abstract
There has been substantial progress in recent years, both in the theory and in ab initio codes for calculations of X-ray absorption spectra (XAS), and in particular, the near edge structure (XANES). This progress is a sequel to the successful development of the theory and interpretation of extended X-ray absorption fine structure (EXAFS). Here, we review the progress in this field leading up to the current state. We focus on the real-space multiple scattering (RSMS) approach which gives a unified treatment of both EXAFS and XANES, as well as many other spectroscopies. We also discuss the close connection between RSMS theory and excited-state electronic structure, and in particular, corrections to the independent-particle approximation which are essential in a quantitative theory. These developments have led to a number of ab initio codes for the calculation and interpretation of XAS in terms of the electronic structure and coordination chemistry of materials.

## 1. Introduction
Significant progress has been made over the last several years in understanding the X-ray absorption near edge spectra (XANES), i.e. the structure in the spectra within about 30 eV of threshold where scattering is strong and inelastic losses are relatively weak. This progress has occurred in parallel with advances in synchrotron radiation X-ray sources and computer technology. The unprecedented precision now available in modern experimental probes of X-ray absorption spectra (XAS) underscores the need for improved theories for quantitative analysis of experiment.

The progress in XANES is a sequel to the dramatic advances in theory of extended X-ray absorption fine structure (EXAFS). The basic theory of EXAFS is now well understood, as discussed in a recent review [1]. Below, we use the acronym XAS to refer to both EXAFS and XANES since they can be treated within a common theoretical framework. This framework illustrates the close connection between the theory of XAS and excited-state electronic structure, since X-ray spectra are directly related to a Green’s function for the excited photoelectron in the presence of a core–hole. The main purpose of this paper is to discuss recent advances in the theory of XAS based on this connection.

In contrast to the now “standard” density functional theory (DFT) of ground-state electronic structure, the theory of excited states is less well understood. Nevertheless, an analogous independent-electron theory has emerged, in which the final states are represented as quasi-particles. This approach, which is the basis for much current work, will be referred to as the **standard quasi-particle theory of XAS**. The theory includes final-state effects, such as the core–hole, inelastic losses, and vibrational effects, and replaces the ground-state exchange-correlation functional with an energy-dependent self-energy. Thus, the approach differs substantially from ground-state theories. As a result, conventional band-structure and quantum-chemistry codes with ground-state potentials are not usually appropriate for general XAS calculations, except close to threshold.

*Figure 1* (not shown) presents a comparison of the XAS of Cu as calculated using ground-state and standard quasi-particle theories, and as measured experimentally. As one can see, the quasi-particle model is in better agreement with experiment at high energies, though discrepancies persist at the edge which require corrections to the quasi-particle theory. Thus, we also discuss recent advances in treating corrections to the quasi-particle approximation, including multiple-electron excitations and the effects of screening of the X-ray field. We also briefly compare a number of approaches for the calculation of XANES. Finally, we discuss how the theory can be used to interpret the XANES in terms of excited-state electronic properties of a material and their coordination chemistry.

## 2. Standard quasi-particle theory of XAS
The basic independent-particle (i.e. quasi-particle) theory of XAS [1–3] has been addressed by many authors. Formally, the contribution to the X-ray absorption coefficient μ from a given core state _i_ at a given X-ray energy ℏω can be calculated using Fermi’s Golden rule:
μ(ω) ∼ Σₙ |⟨i|d|f⟩|² δ(ℏω + Eᵢ − E_f),
where ℏω + Eᵢ ≡ E is the photoelectron energy, _d_ is the coupling to the X-ray field, _Eᵢ_ is the (large negative) energy of the core level, and the sum is over unoccupied final states of energy _E_f_. Most practical calculations are based on the reduction of the many-body Golden rule to a one-electron approximation and the dipole approximation _d_ = ε̂·r. Although the question of precisely which one-electron states to use is not unambiguous, much current work is based on the “final state rule,” in which the final states |f⟩ are calculated in the presence of an appropriately screened core–hole, and all other many-body effects and inelastic losses are lumped into a complex-valued, energy-dependent self-energy or optical potential Σ(E). This standard quasi-particle model is the basis for several XAS codes including FEFF[…].## Quasi-particle theory and self-energy

Within this quasi-particle theory, the final states ψ_f are eigenstates of a Dyson equation (the analog of the Schrödinger equation for excited states)  
$h'ψ_f = \bigl(p^2/2m + V'_{\mathrm{coul}} + Σ(E)\bigr)\,ψ_f = E\,ψ_f$ (2).  
Here, *h′* is the non-Hermitian final-state Hamiltonian, *V′₍coul₎* is the Coulomb potential calculated in the presence of the screened core–hole, and *Σ(E)* is the photo-electron self-energy in the quasi-particle approximation.

The crucial difference between ground-state electronic structure and excited states is the need for *Σ(E)* and the core–hole. The self-energy is essentially a dynamically screened exchange interaction, analogous to the exchange–correlation potential *Vₓc* of ground-state DFT. Typically, the real part of *Σ* varies by ≈10 eV over XAS energies, while the imaginary part is negative and varies by ≈5 eV, accounting for extrinsic inelastic losses (final-state broadening) and systematic peak shifts relative to ground-state theories.

Practical XAS codes commonly compute *Σ(E)* via the GW approximation of Hedin, using a plasmon-pole model for the dielectric function (the Hedin–Lundqvist self-energy). This works well for EXAFS and near threshold but tends to overestimate losses in XANES. Developing more accurate algorithms for *Σ(E)* remains a major challenge.

Independent-electron theories also neglect many-body excitations (e.g. intrinsic losses from sudden core–hole creation), typically overestimating fine-structure amplitudes by ≈10%. Local-field effects and screening of the X-ray field can be important—especially for soft X-rays and transition-metal L-shell XAS. The standard theory is not yet quantitative for strongly correlated or strongly atomic-like systems, where multiplet effects dominate.

The real-space multiple-scattering (RSMS) approach is the real-space analog of the KKR band-structure method. It exploits the connection between XAS and electronic structure to provide an *ab initio* method for calculating XAS over extended energy ranges—even in aperiodic systems.

Final-state calculations via Fermi’s Golden Rule are often a bottleneck for low-symmetry systems. Instead, one rewrites XAS in terms of the photoelectron Green’s function *G* in real space, implicitly summing over all final states. Using the spectral representation  
$-\tfrac{1}{\pi}\,\mathrm{Im}\,G = \sum_f |f⟩⟨f|\,δ(E−E_f)$,  
the Golden Rule becomes  
$μ ∼ -\tfrac{1}{\pi}\,\mathrm{Im}\,⟨i|\,\hatε·\mathbf r'\,G(\mathbf r',\mathbf r,E)\,\hatε·\mathbf r\,|i⟩$ (3).  

Inelastic losses limit the XAS probing range to clusters of a few hundred atoms around the absorber. The cluster size is set by the mean-free path (controlled by the core–hole and final-state lifetimes), and at high energies the scattering is weak enough that perturbation theory converges well.

RSMS begins by separating the potential into site-localized “scattering potentials” *v_R*:  
$V'_{\mathrm{coul}} + Σ(E) = \sum_R v_R(\mathbf r - \mathbf R)$ (4).  

The propagator is then separable,  
$G(\mathbf r',\mathbf r,E) = \sum_{L,L'} R_L(\mathbf r)\,G_{L,L'}(E)\,R_{L'}(\mathbf r')$,  
and the absorption reduces to dipole matrix elements $M_L = ⟨i|\hatε·\mathbf r|L⟩$ and the propagator matrix $G_{L,L'}$:  
$μ(E) = -\tfrac{4π e^2 ω}{c}\,\mathrm{Im}\sum_{L,L'} M_L(E)\,G_{L,L'}(E)\,M_{L'}(E)$ (5),  
with $L=(l,m)$ the angular-momentum indices. Relativistic effects (esp. spin–orbit coupling) are treated via a Dirac–Fock approach in FEFF.

At moderate energies, self-consistency is unimportant and overlapping-atom approximations suffice; for XANES, self-consistent muffin-tin potentials are almost always used (as in FEFF8), providing accurate Fermi energies *E_F* and valence occupations. Full-potential RSMS methods are under active development to capture anisotropic and few-eV effects near threshold.

The total propagator splits into central‐atom and multiple‐scattering parts: $G=G^0+G^{\mathrm sc}$, giving  
$μ = μ^0\,(1 + χ)$ (6),  
with $χ = \mathrm{Im}\,\mathrm{Tr}_m\,G^{\mathrm sc}_{L,L}$. The multiple-scattering term is  
$G^{\mathrm sc} = e^{iδ}\,\bigl[1 - G^0 T\bigr]^{-1}\,G^0\,e^{iδ'}$ (7),  
consistent with the experimental definition $χ=(μ-μ^0)/μ^0$.  It also has a path‐expansion form,  
$G^{\mathrm sc} = e^{iδ'}\bigl[G^0 T G^0 + G^0 T G^0 T G^0 + \dots\bigr]e^{iδ}$ (8),  
where each term represents successive scattering orders. For EXAFS, this converges rapidly; for XANES, one generally needs either full matrix inversion or Lanczos methods.

An efficient curved-wave path‐expansion based on the Rehr–Albers formalism yields an EXAFS-like expression:  
$χ(k) = S_0^2 \sum_R \dfrac{|f_{\mathrm{eff}}(k)|}{k\,R^2}\,\sin\bigl(2kR + \Phi_k\bigr)\,e^{-2R/λ_k}\,e^{-2σ^2k^2}$ (9),  
where $k=\sqrt{2(E-E_0)}$, $λ_k≈k/(|\mathrm{Im}Σ|+Γ/2)$ is the mean-free path, and $σ^2$ the mean-square path‐length fluctuation. Thermal and structural disorder introduce a Debye–Waller damping $e^{-2σ^2k^2}$, crucial at high *k* but less so in the XANES region. Full-potential and disorder effects remain active research areas.## 2.1 Cumulant expansion and Debye–Waller factors

One of the key theoretical developments in XAFS theory is the cumulant expansion, which yields an efficient parameterization of thermal and configurational disorder [16,17] in terms of a few moments or cumulants σ(n) of the pair distribution function. Formally, this gives rise to a complex Debye–Waller factor  
$ \exp\bigl[\sum_n (2ik)^n \sigma^{(n)}/n!\bigr] $  
in \(G_{\rm sc}\), contributing to both amplitude and phase of XAFS. The thermal contributions to σ² can often be fit to a correlated Debye model [18]; the first cumulant σ(1) represents thermal expansion, while the third cumulant σ(3) characterizes skewness of the pair distribution. These odd–order terms affect the fine-structure phase, especially at high energy, giving a contribution  
$2k\,\sigma^{(1)} - \tfrac{4k^3}{3}\,\sigma^{(3)} + \cdots$.  

To leading order in the anharmonicity parameter one finds relations between cumulants [19], such as σ(1) ∝ σ(2)(T) and a corresponding relation for σ(2). The third cumulant is important in bond-distance determinations and thermal-expansion interpretations; neglecting σ(3) often yields unphysically short bond distances in EXAFS fits. Improved treatments of Debye–Waller factors, going beyond the correlated Debye approximation [20], permit fits to local spring constants—crucial for highly anisotropic materials like polymers and biological systems. Other approaches include parameterizing the N-particle distribution [21] or molecular-dynamics methods [22], although accurate ab initio treatments remain computationally intensive.

## 2.2 Fast parallel, Lanczos XANES calculations
Full multiple-scattering (MS) XANES calculations require matrix inversion scaling as the cube of the system size, making them more time-consuming than EXAFS (where typically ∼10² paths suffice). This limits practical fitting schemes for chemical information beyond geometry. Modern Lanczos algorithms, however, are stable and can substantially speed up matrix inversion [23]. Incorporated in FEFF 8.2, the Lanczos option naturally interpolates between full and finite MS limits: the number of Lanczos iterations needed for convergence corresponds roughly to the MS order required. For Si, iterations drop from ∼10² near threshold to ∼10 about 35 eV above the edge, where the path expansion then converges. This clarifies MS convergence versus energy and distinguishes EXAFS from XANES based on convergence behavior.

Parallelization yields even more dramatic time reductions, with compute time scaling as \(T_0 + T_1/N\) for N processors and providing roughly two orders of magnitude speedup with ∼10² processors [23]. FEFF 8 implements parallelization via MPI [24], enabling XANES calculations for systems of ∼10³ atoms in about 1 CPU-h on large parallel machines—essential for low-Z materials like Si with long mean-free paths and core-hole lifetimes.

## 2.3 Comparison with other approaches
Besides the real-space multiple-scattering (RSMS) method, many one-particle approaches exist for XANES, each with advantages, disadvantages, and validity ranges:
- **Ground-state quantum chemistry codes** (e.g., GAUSSIAN [25], DMOL [26]) and **band-structure codes** (e.g., WIEN2K [27], CASTEP [28], PARATEC [29], VASP [30]) are based on density functional theory. They give accurate ground-state properties but neglect self-energy effects, resulting in systematic shifts and amplitude errors in calculated spectra. To match experiment, energy axes often must be rescaled by factors ∼1.06 [31].  
- **Static screened core-hole potentials** can improve agreement, e.g. via supercell approaches in band-structure codes [32] or transition-state approximations in local-orbital codes like STOBE [33]. Inclusion of GW self-energies is under development (e.g., in PARATEC [29]).  

By contrast, the RSMS approach includes final-state self-energy and core-hole effects in a relativistic all-electron real-space framework, applicable from threshold to >1 keV. It is currently the only method enabling quantitative high-energy EXAFS calculations. Its main limitation is reliance on muffin-tin potentials; full-potential real-space methods (e.g., Joly et al.’s Cartesian grid approach [34]) are in progress but currently limited to low energies.

## 3. Many-body effects—inelastic losses and local-field effects
### 3.1 Inelastic losses
Inelastic losses such as shake-up and shake-off processes are crucial for quantitative XAS amplitudes [35–37]. The standard quasi-particle model includes only extrinsic losses (those arising during photoelectron propagation) and thus overestimates peak amplitudes by ∼10%, which can lead to incorrect coordination numbers. A proper treatment must also include intrinsic losses (those arising from core-hole creation) and interference between extrinsic and intrinsic excitations; near thresholds these interfere strongly and largely cancel due to opposite coupling signs.

A promising quantitative framework is the quasi-boson extension by Campbell et al. [38], generalizing the GW approximation to include edge-singularity effects and final-state rule corrections. It introduces an effective one-particle propagator \(G_{\rm eff}\) with an asymmetric quasi-particle peak plus broad, energy-dependent satellites. The total XAS is expressed as a convolution of the one-electron spectrum μ(1) with a spectral function \(A(\omega,\omega')\):
\[
\mu(\omega) = \int d\omega'\,A(\omega,\omega')\,\mu^{(1)}(\omega - \omega') \equiv \langle \mu^{(1)}\rangle.
\]

Here, \(A(\omega,\omega')\) features a sharp quasi-particle peak of strength \(Z^*\approx0.9\) and width \(\Im \Sigma\), plus broad satellites. This theory yields semi-quantitative values for the XAFS amplitude reduction factor \(S_0^2(\omega)\approx0.9\), explains the weakness of multi-electron excitations in XAS, and recovers the sudden-approximation limit at high energies when interference becomes negligible.electron and plasmon excitations (e.g. shake-off) in the system. The one-electron XAS μ^(1) is similar to that in the Golden rule in Eq. (1), except that the dipole operator d→_P contains a projection operator P onto unoccupied states. This operator prevents spurious transitions to occupied states in the standard model, and can be shown to account for weak edge singularity effects close to the edge.

The quasi-boson (oscillator) model Hamiltonian is similar to that introduced in Ref. [36] for photoemission. The essence of the model is that the electron–hole type excitations are represented by bosons a_n with energies ω_n, and the electron–charge fluctuation couplings are represented by terms linear in the boson operators. These coupling terms V_n are labeled by an index n. They are termed fluctuation potentials and can be determined from an RPA-type dielectric function.

The key result, obtained by an expansion to second order in the coupling functions V_n, is an expression for the effective propagator G_eff which includes, respectively, the extrinsic and intrinsic losses and (with a minus sign) interference terms (11) G_eff(ω) = e^(−a) [ G(ω) + ∑_n (V^n_{bb}/ω_n)^2 G(ω−ω_n) − 2 ∑_n (V^n_{bb}/ω_n) G(ω−ω_n) V^n G(ω) ], where the terms in ω_n give rise to the satellite excitations. Here the functions G(ω) ≡ Z[ω − h′ − Σ(ω) + iγ]^(−1) are damped Green’s functions calculated in the presence of a core–hole potential; they are equivalent to those in the standard quasi-particle model except for a renormalization constant Z of order exp(−a), where a ≈ 0.3 characterizes the dimensionless strength of the satellites. The above expression yields an expression for the spectral function A(ω,ω′) and hence the XAS μ(ω) as an expansion in damped one-particle Green’s functions. The approach, thus, avoids the calculation of correlated many-body final states using CI or other methods. Moreover, it is efficient since details in the shape of A are not essential, as they are averaged over in the convolution.

The various contributions to A can be represented as a sum of quasi-particle and satellite terms (12) A_eff(ω, ω′) = A_qp(ω, ω′) + A_sat(ω, ω′). Here A_qp represents the sharp quasi-particle peak and A_sat(ω, ω′) = A_extr(ω, ω′) + A_intr(ω, ω′) − 2 A_inter(ω, ω′) comes from the extrinsic and intrinsic satellites and tends to be suppressed by the interference satellites. Near threshold the net weight of each of the contributions A_extr, A_inter and A_intr is equal to the strength parameter a, and their shapes are similar, so that the sum of all of these contributions tend to cancel, thus suppressing multi-electron excitations. Also near threshold the interference contribution to the quasi-particle peak a(ω) ≈ a. These results imply that the net strength of the main quasi-particle peak becomes nearly unity at threshold, Z exp(−a)(1 + 2a) → 1 + O(a²) and hence the standard quasi-particle model is recovered close to threshold.

It is interesting to examine how the extrinsic and intrinsic losses and interference affect XAFS. Since the fine structure χ^(1)(ω) is rapidly varying and energy-dependent, the effect of a convolution ⟨μ^(1)⟩ = μ₀[1 + ⟨χ^(1)⟩] over a (normalized, positive) spectral function Ã_eff(ω, ω′) is a decreased and phase-shifted XAFS amplitude. The effect on each multiple-scattering path of length R can be expressed as a “phasor sum” over the effective spectral function analogous to that derived using the sudden approximation [35] (13) S₀²(ω, R) = ∫₀^ω dω′ Ã_eff(ω, ω′) e^{i 2 [k(ω,ω′) − k(ω)] R} = |S₀(ω, R)|² e^{i Φ₀(ω, R)}. Qualitatively, the many-body amplitude reduction factor S₀²(ω, R) is weakly energy-dependent, and reduces to unity (the quasi-particle limit) at low energies where interference is complete. Over a wide range, S₀²(ω, R) is roughly constant near about 0.9 and then smoothly increases toward unity at very high energies. As a result, various independent-particle theories can be corrected for multiple-electron excitations using the quasi-boson approximation for the spectral function. As shown by Campbell et al. [38], the convolution also tends to correct for the discrepancy between experiment and theory based on the standard quasi-particle model (Fig. 1) close to the edge.

3.2 Local field effects in XAS
Although the standard quasi-particle model is generally successful in describing XANES, it can sometimes fail near soft X-ray edges. A glaring example is the L₂,₃ edges of 3d transition metals [39–41]. For these materials, the independent-electron approximation predicts an L₃/L₂ transition intensity “branching ratio” near 2:1, while the observed ratio varies considerably with atomic number Z and is closer to 1:1 for metals like Ti and V. The trends in this behavior have been calculated using atomic models, e.g. configuration-interaction and multiplet codes. An efficient alternative approach for treating the problem is the time-dependent local density approximation (TDLDA) [6]. In this approach, the Coulomb interaction naturally mixes different many-body particle–hole states, leading to a shift of oscillator strength from the L₃ to the L₂. The physics of this mixing is similar in the CI and multiplet treatments. The TDLDA approach also yields a physical interpretation of these many-body effects in terms of screening of the X-ray field as discussed below.

The TDLDA [6,41–43] provides an efficient formalism for calculations of response functions within the local density approximation. This approach was originally introduced for atoms [6], but has since been extended to many other systems [41]. The TDLDA equations are analogous to the Bethe–Salpeter equation (BSE) [44–46], which provides a systematic many-body framework for treating particle–hole interactions in XANES. The main difference between the TDLDA and the BSE lies in the form of the interaction kernel K. The TDLDA uses a local exchange–correlation contribution f_xc based on density functional theory for the direct terms, while the BSE uses the non-local screened Coulomb interaction W which gives an improved treatment of the screened core–hole potential. Here we will focus on the TDLDA approach.

Within the TDLDA, the XAS (or cross-section) μ(ω) can be expressed as an integral over the non-interacting response function χ₀(r, r′, ω) and the screened X-ray field φ(r, ω). Then the XAS can be written as (14) μ(ω) = −(4πω/c) ∫ d r d r′ ~d*(r, ω)[Im χ₀(r, r′, ω)] ~d(r′, ω), χ₀(r, r′, ω) = Σ_{ij} (f_i − f_j) ψ_i*(r)ψ_i(r′)ψ_j*(r′)ψ_j(r) / [ω + E_i − E_j + i 0⁺]. This expression for the XAS μ in the TDLDA is equivalent to an analogous expression with ~d replaced by the external X-ray field d and χ₀ by the full response function χ = [1 − χ₀K]⁻¹ χ₀(ω) [6]. Here f_i are Fermi occupation numbers (1 or 0), and the sums run over all one-electron eigenstates ψ_i(r) of the ground-state Hamiltonian. The screened dipole coupling ~d(ω) consists of the external field d (in the dipole approximation) plus an induced local field, which in matrix form is given by (15) ~d(ω) = ε⁻¹(ω)d(ω), ε(ω) = 1 − K(ω)χ₀(ω). Here the interaction kernel K(r, r′, ω) = V(r, r′) + f_xc(r, r′, ω) denotes the particle–hole interaction (or TDLDA kernel), which contains direct and exchange parts, and V = 1/|r − r′| is the Coulomb interaction.

This TDLDA formalism fits well with the RSMS formalism used in FEFF8. In particular, the screening of both the X-ray field and the core–hole interaction only affects the particle–hole states and can be included implicitly in terms of renormalized dipole matrix elements. Otherwise the expression and hence the XAFS is unchanged. Thus, the XAS can be re-expressed as (16) μ(ω) = (4πe²ω/c) Σ_{i, LL′} ~M_{iL}(ω) ρ_{LL′}(E) ~M_{iL′}(ω), where ~M_{iL}(ω) = ⟨R_L|~d|i⟩. The implementation of the TDLDA approach evidently requires an adequate treatment of the exchange–correlation functional f_xc(ω), which is much less well understood than the ground-state functional. We have found that calculations of dynamical screening can be avoided for L₂,₃ XAS by using a simplified dynamic TDLDA model, based on the BSE [47]. This approximation yields good agreement with experiment for the L₂,₃ XAS of 3d transition metals, and also for the large blue-shifts observed in some soft X-ray spectra [47].

4. Quantitative interpretation of XAS
In independent developments, robust EXAFS analysis procedures have been developed based on the high-order MS path approach, as briefly reviewed in Ref. [1]. These procedures are now being used extensively to extract information concerning the coordination chemistry of materials. An illustrative set of examples is the coordination chemistry of minerals [48]. Some effort has also gone into the interpretation of XANES data. However, the quantitative analysis of XANES is still not well developed. In particular, there is also a need for a reliable inverse method of extracting chemical and geometrical structure from XANES, due to significant MS corrections. On the other hand, there has been significant recent progress [49,50] which shows that significant geometrical information can be obtained from XANES alone, analogous to EXAFS analysis. Moreover, the XANES signal also depends sensitively on the point-group symmetry of the absorbing atom due to the dependence of the strong MS terms on symmetry. In addition, the shape of the XANES directly reflects the excited-state electronic densities of states in a material. The reason is that the local projected density of states (LDOS) ρ has a form analogous to XAFS, i.e. (17) ρ(E) = ρ₀(E)[1 + χ(E)], where E is the photoelectron energy, so that both share similar fine structure. As a result, one can deduce from experimental XAS measurements the unoccupied LDOS ρ(E) as (18) ρ(E) ≈ γ(E) μ(E), where the factor γ(E) = ρ₀(E)/μ₀(E) is a smooth, atomic ratio, which includes the effects of the core–hole interaction in μ₀. Peaks in the LDOS [51,52] at low energy correspond to transitions between different molecular-orbital (MO) levels. However, at higher energies the MO picture becomes more difficult to apply [53]. This and analogous relations have recently been exploited to interpret charge counts from XANES, e.g. in transition-metal oxides [53] and also spin- and orbital-moments from XMCD [54].

As an example, we show in Fig. 2 the XANES for the metal oxide CaO as calculated from FEFF8 (solid line) and experiment (dashes). The comparison with no adjustable parameters is semi-quantitative, and is typical of results that can currently be obtained for K-shell XAS. The comparison also shows that additional broadening (e.g. to account for experimental resolution) should improve the agreement of peak amplitudes. We also show in Fig. 2 the local pDOS of the Ca atom with the core–hole. The pDOS has been shifted vertically for clarity; the abscissa has been shifted by the threshold energy E₀ = 4051.8 eV for comparison with the X-ray spectrum.## 5. Applications to X-ray spectroscopies

Calculations without a core–hole, e.g. from conventional band-structure codes, have a much smaller main peak and give much poorer agreement. Improvements in the edge shape will likely require non-spherical corrections and improved treatments of the self-energy and inelastic losses.

The SCF calculations also determine the fractional occupations of the various angular momentum states above the core levels. For the Ca atoms, one finds a solid-state configuration of s⁰·³¹ p⁰·⁴⁴ d⁰·⁸⁹, i.e. with a net charge of +0·37, in contrast to an atomic configuration of s². For the O atoms, the configuration is s¹·⁸⁵ p⁴·⁴⁸ d⁰·₀₃₆ with a net charge of −0·37. These results show that the charge transfer to the O and Ca atoms is proportional to their valence, i.e. ±2 with a factor of about 0·2. The configuration of the Ca with the core–hole is s⁰·³₆ p⁰·₅₄ d¹·⁵₄, with a net charge of +0·44, showing that there is approximately one additional charge on the absorbing Ca atom which screens the core–hole. Similar factors have been observed in other cases as well, though it is not clear that this is a general rule.

The RSMS formalism outlined above has been incorporated in various XANES codes. For example, the implementation in FEFF8 permits self-consistent calculations of both XAS and electronic structure. This code has already been applied extensively. Tests show that this approach (without a core–hole) can also calculate LDOS and hence ground-state electronic structure in good agreement with full-potential band-structure codes such as WIEN2K. The FEFF8 code is also highly automated and “user friendly,” requiring a minimum of input and few adjustable parameters.

Because the underlying physics is similar, the same RSMS approach can be applied to many other spectroscopies, e.g.:
- electron energy loss spectra (EELS)
- diffraction anomalous fine structure (DAFS)
- X-ray elastic scattering amplitude (XS)

In the latter application, both real and imaginary parts of the anomalous X-ray scattering amplitude are calculated simultaneously in the complex energy plane, without the necessity of a Kramers–Kronig transform. The presence of XAFS gives rise to significant solid-state contributions in the anomalous scattering amplitudes, which are ignored in the standard tables. The approach includes dipole–quadrupole and quadrupole couplings, and thus also permits calculations of X-ray natural circular dichroism (XNCD) and the X-ray anomalous cross scattering amplitude (XACS), both of which are due to solid-state effects. Similarly, calculations of X-ray magnetic circular dichroism (XMCD) have been carried out. The XMCD for the K-shell emphasizes the importance of spin-orbit relativistic effects in the final state.

RSMS techniques have also been used for photoelectron diffraction (PD). Many of these specialized applications are not yet highly automated. However, the latest FEFF codes have been modularized to simplify both the automation and extensions to various spectroscopies and analysis tools as they are developed.

## 6. Conclusions
Codes based on RSMS theory now make possible a general treatment of XAS, encompassing XANES and EXAFS, as well as a number of other X-ray spectroscopies. The availability of a quantitative theory is key to an interpretation of the spectra in terms of local geometrical structure and electronic structure. The current state of XAFS is now highly quantitative and widely used. With reasonable estimates of the many-body amplitude factor, the error in fine-structure amplitudes is usually less than 10%. With recent developments in algorithms and calculational speed, quantitative calculations and fits are rapidly becoming possible in XANES as well, although the agreement is still only semi-quantitative in many cases. Improved treatments of the self-energy, inelastic losses, and core–hole effects are clearly desirable. Also, efficient approaches for treating many-body corrections such as local field effects and inelastic losses have been developed, although these are not yet incorporated into widely available codes. Thus, XANES is beginning to realize its promise as a quantitative tool for elucidating both the coordination chemistry and electronic structure in materials.

## Acknowledgements
We gratefully acknowledge contributions and suggestions by our colleagues, in particular R.C. Albers, L. Campbell, L. Hedin, A. Nesvizhskii, and E. Shirley. This work was supported in part by the US Department of Energy grants DE-FG06-97ER45623, by a SSRL subcontract NIH Grant RR 01209, and was facilitated by the DOE Computational Materials Sciences Network.