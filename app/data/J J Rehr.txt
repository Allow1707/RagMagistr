I. INTRODUCTION:
X-ray absorption fine structure (XAFS) refers to the oscillatory structure in the x-ray absorption coefficient just above an x-ray absorption edge. This turns out to be a unique signature of a given material; it also depends on the detailed atomic structure and electronic and vibrational properties of the material. For this reason, XAFS is a very important probe of materials, since knowledge of local atomic structure, i.e., the species of atoms present and their locations, is essential to progress in many scientific fields, whether for biology, chemistry, electronics, geophysics, metallurgy, or materials science. However, extracting this information with precision in the often complicated, aperiodic materials of importance in modern science and technology is not easy, even with the subtle and refined experimental techniques currently available.Over the past three decades the technique of XAFS has made great strides toward the goal of providing such information. The existence of intense new synchrotron x-ray sources alone was not enough to achieve this goal, even though such facilities spurred considerable progress. In addition, the full success of the XAFS technique must be attributed in large part to advances in theory, which have led ultimately to a highly quantitative understanding of the phenomena. The purpose of this article is to review these advances, many of which have taken place only within the last decade. We focus primarily on extended XAFS (EXAFS), the fine structure in the absorption well above an x-ray edge, which is now largely understood in terms of a high-order multiple-scattering theory. To a lesser extent, we also discuss progress in understanding the fine structure close to an edge, i.e., the x-ray absorption near-edge structure (XANES), from the same unified one-particle, multiplescattering viewpoint. However, the theory of XANES is not as yet fully quantitative and requires different physical considerations. Although this field is the subject of many current investigations, a complete understanding remains elusive. Therefore this review is generally restricted to the regime where the multiple-scattering expansion can be assumed to be convergent and the theory is well established. This region typically begins several eV or more above an absorption edge. Earlier reviews of the field are given, for example, by

A. X-ray absorption:
X-ray absorption spectroscopy measures the absorption of x rays as a function of x-ray energy Eϭប. More specifically, the x-ray absorption coefficient (E)ϭ Ϫd ln I/dx is determined from the decay in the x-ray beam intensity I with distance x (Fig.The first feature is illustrative of the well-understood quantum-mechanical phenomenon of x-ray absorption by atoms, as described, for example, by Fermi's ''golden rule'' in standard texts (e.g.,

͑E ͒ϭ͓͑ E ͒Ϫ:
where 0 (E) is the smoothly varying atomic-like background absorption (including contributions, if any, from other edges), and ⌬ 0 is a normalization factor that arises from the net increase in the total atomic background absorption at the edge in question. In practice, this normalization factor is often approximated by the magnitude of the jump in absorption at the edge. The error in this approximation can be accounted for by a small (typically about 10%) correction to the XAFS Debye-Waller factor, which is called the McMaster correction (seeThe generally weak oscillatory wiggles (Fig.

B. Early history of XAFS:
Roughly 70 years have elapsed since the phenomenon of EXAFS was first observed, and it has taken nearly that long to realize that accurate, detailed, structural information could be extracted from it and to develop a quantitative theory. Early progress was impeded by experimental limitations of the then available x-ray sources. For recent historical reviews, see, for example,In the early years, the precise origin of EXAFS was controversialHere the x axis for the plot has been converted to energy units to make it consistent with the other plots. The values for have been multiplied by a factor of 3 relative to the (E) plot to make it show up better. Notice that oscillates around zero.states for available energy levels.The short-range-order theory reflects the quantummechanical wavelike nature of the final, excited, photoelectron state. That is, the dominant wiggles in the XAFS spectrum are interpreted as a quantuminterference phenomenon. The outgoing photoelectron can be viewed as a quantum wave that spreads out over the solid, much as a rock thrown in a pond creates an expanding spherical wave in water. In the same way that water waves reflect off of any obstacles in the pond and, in turn, reflect other waves back toward the original point of the splash, so will other atoms reflect the electron wave back towards the original atom (see Fig.The modern resolution to the controversy between the short-and long-range-order approaches lies in the energy-dependent competition between scattering strength and inelastic losses. A crucial element is the recognition that a high-energy, excited photoelectron state is not infinitely long lived, but must decay as a function of time and distance and hence cannot probe long-range effects. This decay is due primarily to inelastic losses (i.e., ''extrinsic losses'') as it traverses the material, either by interacting with and exciting other electrons in the solid, or by creating collective excitations (e.g., losing energy to plasmon production). In addition, the intrinsic lifetime of the core-hole state (i.e., ''intrinsic losses'') must be considered. In phenomenological terms, the original outgoing wave of the excited photoelectron dies away as it moves further away from the absorbing atom. Ultimately it becomes too weak to significantly reflect any waves off of distant atoms. The returning reflected waves also suffer this same type of extinction. The net effect is that XAFS can only measure the local atomic structure over a range limited by the net lifetime (or effective mean free path) of the excited photoelectron. This range is typically on the order of tens of angstroms or an inverse lifetime of a few eV and roughly follows a universal dependence (see, for example,The long-range-order theory, on the other hand, emphasizes the density of states of the extended, excitedstate, energy levels of the entire material, which can be important at low energies or for strong scattering. Indeed, such an approach is often needed for descriptions of ground-state electronic structure, for example, by band-structure codes. However, as we shall discuss later on, properly broadening the results of this type of approach with the inelastic losses and lifetime considerations in effect washes out the fine structure in the spectra due to the long-range nature of the energy states, thereby recovering the results of short-range-order theory at sufficiently high energies. As noted above, the core hole that is left behind by the excited electron (see Fig.

C. Structural information in XAFS:
It was only in the early 1970s, following the pioneering work ofThe needed theoretical developments did not all come at once, but through a series of continual refinements that were incorporated one by one. To give an overview of these developments it is useful to review the heuristic treatment of XAFS, starting with the more precise, semi-phenomenological treatment ofFirst, we summarize the main physical quantities of interest. The x-ray absorption coefficient (E), which is the attenuation of the x-ray beam per unit distance, is a strong function of x-ray energy Eϭប and exhibits abrupt jumps at ''absorption edges,'' i.e., the thresholds បϭ͉E c ͉ for photoexcitation of electrons from deep atomic core levels E c . If the x-ray photon has an energy higher than the threshold energy E c , the extra energy is taken up by the excited photoelectron as a higher kinetic energy. In order to separate the structural information from the energy dependence of the absorption cross sections, the normalized XAFS spectrum (see Fig.According to the Fermi golden rule, the x-ray absorption coefficient is proportional to a transition matrix element squared. For highly localized core electrons the transition matrix element is proportional to the probability ͉ k (r)͉ 2 that the photoelectron is found at the atom where the photon is absorbed. (Typically, the core orbitals are of size 1/Z in Bohr units, where Z is the atomic number. Throughout this paper we shall generally use atomic units eϭបϭmϭ1 in theoretical formulas; however, experimental distances will generally be given in Å and energies in eV.) The total wave k can be expressed in terms of an outgoing wave emitted at the absorbing atom plus incoming waves that are scattered back by neighboring atoms (see Fig.The validity of the Kronig short-range-order theory was largely substantiated byHere the structural parameters are the interatomic distances R, the coordination number (or number of equivalent scatterers) N R , and the temperaturedependent rms fluctuation in bond length , which should also include effects due to structural disorder. In addition, f(k)ϭ͉f(k)͉e i⌽(k) is the backscattering amplitude, ␦ c is central-atom partial-wave phase shift of the final state, and (k) is the energy-dependent XAFS mean free path (not to be confused with the de Broglie wavelength). Although the overall amplitude factor S 0 2 did not appear in the original formula, we have added it here for completeness, since the resulting equation can be obtained from a more detailed many-body theory discussed below (Sec. II.C), provided the terms are appropriately renormalized. Moreover, although the original EXAFS formula referred only to single-scattering contributions from neighboring shells of atoms, the same formula can be generalizedIn a very transparent and simple form, this formula contains all of the key elements that a correct theory must have and also provides a convenient parametrization for fitting the local atomic structure around the absorbing atom to the experimental EXAFS data. Most of the eventual improvements of the theory can be viewed as successive refinements of these key elements. The dependence of the oscillatory structure on interatomic distance and energy is clearly reflected by the sin(2kR) term. The decay of the wave due to the mean free path or finite lifetime (including core-hole lifetime) of the photoelectron is captured by the exponential term e Ϫ2R/ . This factor is largely responsible for the relatively short range (generally a few tens of Å) in a material probed by EXAFS experiment. The strength of the reflected interfering waves depends on the type and number of neighboring atoms through the backscattering amplitude ͉f(k)͉ [Fig.Another effect that we have not yet discussed is the Debye-Waller factor, which is given to a good approximation by e Ϫ2 2 k 2 . This factor is due partly to thermal effects, which cause all of the atoms to jiggle around their equilibrium atomic positions. These slight movements smear the sharp interference pattern of the rap-idly varying sin(2kR) term that would be seen if the atoms were unmoving (Fig.response to the creation of the core hole. Although S 0 2 is weakly energy dependent, it is usually approximated by a constant. A fully quantitative theory has yet to be developed.The inclusion of inelastic losses and Debye-Waller factors was crucial to the success of the modern short-range-order theory of XAFS. Moreover, using the representation of EXAFS given by Eq. (A key development has been the development of an accurate treatment of scattering by taking curved-wave effects into account. A simplification made in early work is the approximate treatment of the shape of the electron waves. At large distances from the center of a wave, the curvature of a spherical wave front lessens, and it becomes more and more plane-wave-like. The mathematics of the scattering of plane waves is considerably simpler than that of curved waves and can be treated by a plane-wave scattering amplitude f(k). This approximation, which is sometimes called the plane-wave approximation, was originally used to derive the simple result of Eq. (2). A more precise treatment of the planewave approximation was later given by

D. Multiple scattering:
Another key development in the theory is that of an accurate treatment of multiple-scattering effects. One obvious weakness of the phenomenological EXAFS theory is that it takes into account only the simplest, but usually the most dominant, form of scattering, i.e., reflections by neighboring atoms directly back to the absorbing atom (this type of scattering is often called ''backscattering'' or ''single scattering''). More generally, atoms can reflect the electron wave onto other atoms that then reflect off of still other atoms (Fig.The formal multiple-scattering theoryA strategy that overcomes all of these computational problems was developed by the present authors

E. Other improvements:
Yet another key improvement to early EXAFS theories came with the replacement of the phenomenological mean-free-path term by ab initio theoretical calculations of inelastic lossesPerhaps the most pervasive and important influence of all of the improvements to the phenomenological short-range-order theory was the development of fast ab initio computer codes for the calculation of EXAFS, together with the ready availability of faster computers. Such ab initio codes replace the need for tables and give a more accurate treatment of the local environment than free-atom approximations on which the tables were based. Most of these codes now include multiplescattering effects, which are important for treating the EXAFS beyond the first coordination shell. For example, the earliest such EXAFS code, known as EX-CURV

F. Outline:
In the remainder of this paper, we review in more detail the modern theoretical approaches to XAFS calculations. We focus primarily on the conceptual ideas needed for an accurate theory of the XAFS spectra . For example, because of the large kinetic energy of the photoelectron state compared to chemical energies, the physical considerations needed in XAFS theory are rather different from those in modern ground-state electronic-structure calculations or in XANES. We also focus especially on deep-core-level absorption, which greatly simplifies the treatment of the initial state. Shallow core absorption and optical absorption often require quite different theoriesThe outline for the rest of the paper is as follows: in Sec. II we discuss the physical processes involved in x-ray absorption and how they are included in modern theories of XAFS. In Sec. III we go into great detail to show how the multiple-scattering theory can be solved. This section has been emphasized, since it is the key to extracting the structural information from XAFS. In the last two sections (IV and V), we introduce additional complications due to thermal disorder, show how well the theory compares to experiment, and summarize the state of XAFS theory. Finally, we mention some connections between XAFS and related spectroscopies.

II. KEY APPROXIMATIONS A. One-electron golden-rule approximation:
The dominant mechanism for the absorption of hard (ϳ10 keV) x rays by matter is the photoexcitation of electrons. Compton scattering is negligible for thin samples and pair production in the energy range of interest is forbidden. Moreover, the weakness of the electromagnetic field (even for current third-generation synchrotron x-ray sources) is such that only processes that are first order in the field are important. In consequence, the x-ray absorption coefficient is proportional to the transition rate as given by Fermi's golden rule. Most practical calculations of x-ray absorption are based on the one-electron approximation of the golden rule,(3) Unless otherwise specified, for clarity, we shall use atomic units (eϭបϭmϭ1) in the formalism presented in this paper; when results are calculated for comparison with experiment, energies will be given in eV and distances in Å. The reduction to an effective one-electron approximation is discussed in detail in Sec. II.C.2. The wave functions i and f in this equation refer, respectively, to the initial and final eigenstates of the effective one-electron Hamiltonians H for the initial state and HЈ for the final state, with energies E i and E f , respectively. That is, the states i and f are generally calculated with different self-consistent potentials in a ⌬SCF approximationFor deep-core excitations, the spatial dependence of the electromagnetic field (vector potential A) can usually be neglected (dipole approximation), i.e., e ik•r Х1. Quadrupole corrections are of order (Z␣) 2 , where Z is the nuclear charge seen by a core electron and ␣ Х1/137 is the fine-structure constant. Likewise, local-field effects are usually negligible for deep-core excitationsHere H is the effective one-particle Hamiltonian and the transition frequency. Similarly, one can derive an acceleration form. Partly owing to its simplicity and partly for numerical and physical considerations, the position form seems preferable for XAFS calculations and deep-core absorption.

B. Scattering potential:
As noted in the Introduction, the oscillatory structure in the XAFS spectra results from the interference between contributions to the photoelectron wave function from various paths the excited photoelectron can take as it scatters off nearby atoms. In an effective one-electron theory this excited electron, as it traverses the solid or molecule, behaves as a quasiparticle that moves in an effective complex-valued ''optical potential.'' Such a lossy potential is needed to calculate the phase shifts, the scattering, and also the damping of the electron. In this section we discuss how such a potential is constructed for practical calculations, as well as the current advantages and limitations involved.The nature of the effective one-particle scattering potential V has been considered by several authors (see, for example,(in atomic units), or its relativistic generalization in terms of the Dirac equation. Here the operatorconsists of the net Coulomb potential V coul felt by the photoelectron and a ''self-energy'' ⌺(E), which is analogous to the exchange-correlation potential V xc in ground-state calculations

Muffin-tin approximation:
Almost all practical XAFS calculations currently rely on a muffin-tin geometry (cf. Figs. 9, 10, and 11), which consists of a spherical scattering potential centered on each atom and a constant value in the interstitial region between atoms. A tremendous amount of mathematical machinery has been built up over the last century that relies on spherical symmetry. The spherical muffin-tin geometry makes it possible to apply this machinery in a very efficient way. In the multiple-scattering approach that most directly connects to the underlying atomic structure of a material (see Sec. III), the muffin tins provide atomic scattering centers that are described completely by atomic phase shifts, which are calculated from spherically symmetric atomiclike potentials inside the muffin tins. Green's-function propagators are employed to connect these scattering centers. Accurate calculations depend on good potentials, since they determine the strength of the scattering at each site.The actual potential in a material (solid or cluster of atoms) is, of course, more complicated. Near the center of each atom, the charge density of the atomic core will be large and dominate the potential. Hence the potential is approximately atomic-like very close to the nucleus, where the spherical approximation is highly accurate. In the outer regions of the atom and between the atoms, the bonding properties of a material determine the distribution of charge, and the potential is generally anisotropic. The degree of anisotropy depends on the type of bonding present (ionic, covalent, or metallic) and the types of atoms that are bonding. In close-packed metals, the electronic wave functions overlap so strongly that the bonding is much more flat and isotropic than in other, more open systems, where there can be strong spatial variations.In EXAFS spectroscopy the kinetic energy of the excited electron is large, and the electron is less sensitive to the details of the potential at the outer edges of the atom and in the regions between the atoms. The electron is mainly scattered by the inner parts of the atomic potential and moves more or less freely in the average potential within the flat interstitial region. It is for this reason that a spherical muffin-tin potential works so well. In the near-edge region (XANES) and for groundstate total-energy calculations, the details of the shape of the interatomic potential are much more important. In Sec. II.B.2.a we shall return to a further discussion of non-muffin-tin effects.

a. Charge density and potential:
The potential within a muffin tin depends on the charge density in this region, and it is essential to use approximations that conserve overall charge neutrality for an accurate determination of the energy reference. Because the muffin tin is centered on a given atom, most of the charge density is that due to the atom in question, with only small contributions in the outer parts due to the tails of neighboring atoms' charge distributions.Perhaps the best charge density to use would be that produced by a modern full-potential self-consistent electronic-structure calculation (e.g.,In practice, full-potential calculations are time consuming and not yet readily available for many complex systems studied by XAFS spectroscopies. Remarkably, they are not usually necessary (except, perhaps, close to an edge), since scattering off the atomic core is far stronger than scattering off the outer parts of the potential. Bigger errors come from the treatment of the selfenergy. Thus simpler prescriptions for the potential have proved to be accurate enough for a wide range of applications for large excitation energies. The easiest and most often used approach is based on overlapping, neutral, atomic-charge densities, which turns out to be a very good approximation to the total ground-state charge distribution. This prescription, pioneered byThe neutral atomic-charge density may be calculated in several ways. Both conventional (nonlocal exchange) Hartree-Fock and local-density-approximation (LDA) atomic codes are readily available. There are also tables of charge densities available, such as those byIn standard electronic-structure calculations a groundstate LDA exchange-correlation potential is typically used for crystalline solids, while a Hartree-Fock exchange is often used for molecular calculations. As noted above, for XAFS applications it is important to take into account the energy dependence of the exchange-correlation potential, which includes the quasiparticle character of the excited electron and reflects the decreasing importance of the Pauli principle with increasing energy. XAFS calculations based on groundstate calculations miss this additional energy dependence and therefore differ systematically from spectra measured experimentally; see Sec. II.C.2.a.

b. Atomic configurations:
In determining the muffin-tin scattering potential, an important consideration is whether to use (1) (initialstate rule) the ground-state charge density, or (2) (finalstate rule) the charge density with the core hole present (which was left behind by the excited photoelectron). In the latter case, which is currently used most often by default, the question of the appropriate atomic configuration for the final state with the core hole is not unambiguous. For the absorbing atom a reasonable approximation is a neutral atomic configuration of a free atom of atomic number Z c ϩ1 with a missing electron in a given core level, corresponding to the fully relaxed ''primary channel''

Interstitial potential:
The interstitial region causes more complications for XAFS than for typical ground-state electronic-structure calculations or for XANES. These complications are the following: (1) the most efficient multiple-scattering treatments assume that the interstitial potential has no spatial variation (i.e., is constant), which is not generally true; (2) for excited-state calculations the interstitial region is lossy and energy dependent; and (3) the critical parameter for determining structural information (the wave number k of the excited photoelectron) depends on the choice made for the average value of the potential in the interstitial region.

a. Muffin-tin corrections: warping:
As discussed above, the electronic charge density in any real material is more complex than that implied by the muffin-tin approximation. Inside the muffin tins the charge density is not perfectly spherical, and in the interstitial region the charge density is not constant. Instead, it is often common to find a buildup of charge between neighboring atoms, where there is significant bonding. This same effect can be intuitively pictured as a consequence of overlapping atomic-charge densities, which also naturally leads to a buildup of charge between neighboring atoms. In order to evaluate the validity of the muffin-tin approximation, we review how nonmuffin-tin corrections to the potential are treated in ground-state electronic-structure calculations.In the electronic-structure literature the spatial variation of the charge density in the interstitial region is sometimes called ''warping'' of the potential or charge density. Methods that include this effect are called ''fullpotential'' techniques (since the muffin-tin potential captures only the spherical part of the potential and misses the spatial dependence in the interstitial region). Such effects are often important for sensitive bonding properties.For EXAFS this effect is of less importance. In addition to the simplification provided by the kinetic energy of the photoelectron being typically much larger than the size of the warping potential, in the muffin-tin ap-proximation the spatial variations in the interstitial region are also reduced by subtracting out the average interstitial potential. This greatly reduces the perturbation on the photoelectron. It is only in the XANES regime that warping begins to be a potentially serious problem, and then only within a few eV of the edge.In band-structure approaches the warping has mainly been treated by taking advantage of the periodicity of the crystal. Any periodic function in a given crystal can be expanded in reciprocal-lattice plane waves. Matrix elements between the basis set used to expand the ground-state wave functions are typically reexpanded in a plane-wave basis, which then makes it mathematically rather easy to calculate the matrix elements that involve the interstitial potential. For most XAFS calculational methods, this periodicity is not assumed (except possibly in band-structure or exact diagonalization approaches; see Sec. III.B), and the simplicity introduced through the plane-wave expansions is not possible. Thus including warping within the XAFS formalism has been found to be very difficult. Although a scattering formalism has been developed by

b. Excited-state effects:
The spectrum of photoelectron (quasiparticle) states, moving in the optical potential V defined by Eq. (Some treatments, e.g.,

c. Energy reference:
The variation of V int (E) over the range of XAFS energies roughly amounts to the magnitude of the groundstate exchange hole, i.e., V xc ϳϪk F / in atomic units, where k F is the Fermi momentum and is typically about 10 eV. To circumvent this ambiguity in the comparison of theoretical XAFS standards with experiment, it is useful to define a fixed energy reference E 0 , the photoabsorption energy threshold. Experimentally, this threshold corresponds to the energy at the onset of an absorption edge. We emphasize that this threshold energy is not necessarily the midpoint of the main-edge step in the x-ray absorption coefficient, but rather at the onset of absorption for a given edge. Self-consistent calculations are needed to determine E 0 precisely

Relativistic effects:
Relativistic effects per se have generally played a secondary role in XAFS theory. Similarly, spin-dependent effects are usually negligible and are manifestly important only when the dominant spin-independent contributions are forced to cancel, as in x-ray magnetic circular dichroism; see, for example,In atomic theory it has long been recognized that relativistic effects are only important for very heavy (large-Z) atoms. For such atoms the kinetic energy of the electrons becomes quite large near the nucleus of the atom where relativistic corrections are essential. Besides modifying the wave functions and energy eigenvalues of the electronic states, these corrections also change the self-consistent potential. In contrast, at large distances from the atom the kinetic energy of the outermost electrons responsible for bonding properties and the photoejected electrons are usually well into the nonrelativistic regime. Thus relativity can strongly affect the production of the photoelectron and hence the atomic background 0Multiple scattering in turn involves knowledge of both the photoelectron propagators connecting different atoms and the scattering t matrices, which depend on the phase shifts of the electrons at a muffin-tin radius. Clearly the electron propagators, which vary as exp(ikR), are essentially nonrelativistic (assuming paramagnetic materials with spin-independent potentials), and thus most of the propagation involves knowledge of the electron's behavior at large distances from the nucleus where relativistic effects are usually negligible, even for heavy atoms at the highest EXAFS energies (about 1500 eV). Thus the only place where relativity can play a substantial role is in the phase shifts themselves. Relativistic effects enter in two ways for such calculations. Because relativistic effects shift wave functions to distances closer to the nucleus, the selfconsistent potential must include relativistic effects. Secondly, for heavy atoms the wave function near the nucleus will be modified and affect the integration of the wave function for calculating the phase shifts, even if the correct self-consistent potential is known; this will modify the phase shift. To account for the first effect, it is standard to use a fully relativistic solution for the core electrons to get their correct charge density. Within the local-density approximation for the electronic potential this is very easy to do and requires almost no computational overhead.For calculating the phase shift of the photoelectron, some approximations have to be made. The chief problem is symmetry. For the spherically averaged potentials used in XAFS, the nonrelativistic wave functions are labeled by spin and orbital angular momentum (l ). Relativistic wave functions have total angular momentum labels j as well as an additional label, usuallyFor very heavy atoms (e.g., 5d's, 4f's, and 5f's) the spin-orbit splitting of the outermost valence electrons can be significant, and a better theory is to retain the relativistic labels and to use the corresponding relativistic phase shifts

Inelastic losses:
As we have stressed, the inclusion of damping due to inelastic losses is a key ingredient in the modern shortrange-order theory of XAFS. These losses give the final photoelectron state a finite lifetime and hence lead effectively to a broadened one-electron spectrum. It is traditional to differentiate two types of inelastic losses in the photoabsorption, namely, intrinsic and extrinsic processes. Extrinsic effects refer to losses in propagation of the photoelectron and include excitations such as plasmons, electron-hole pairs, and inelastic scattering in which the photoelectron loses energy. Many of these processes are the same as for an electron beam as it traverses a solid

Extrinsic losses a. Self-energy:
The extrinsic losses and associated energy shifts can be described in terms of a self-energy operator ⌺(E). This operator is complex valued and energy dependent and arises from the dynamically screened exchange interaction between the photoelectron and the system (cf. Figs.An appropriate generalization of the local-density approximation for excited states is again based on a uniform electron-gas model, e.g., the Hedin-Lundqvist GW/ plasmon-pole self-energy ⌺ HL (E,)The excited-state potential is therefore given by V(E,r ជ) FIG. 13. Energy dependence of the mean free path (E) and the corresponding imaginary part of the self-energy ⌺(E).For convenience, the same (y-axis) numerical scale was used for both quantities (one is positive and one is negative). However, (E) is in units of Å and the Im ⌺ is in eV.ϭV(r ជ)ϩV xc ()ϩ⌺ HL "E,(r ជ)…Ϫ⌺ HL "E F ,(r ជ)…. The advantage of this formulation over other approximations, such as the nonlocal Hartree-Fock or the analogous LDA Dirac-Hara self-energies

b. Mean free path:
The effect of the imaginary part of the self-energy is similar to Lorentzian broadening of the XAFS spectrum with a half-width Im ⌺

c. Energy shifts:
A comparison of XAFS peak energies, as calculated by ground-state band-structure theory or measured in experiment, reveals a systematic shift that can be represented at low energies by an approximately linear scaling with energy, i.e., E exp ϭE th (1ϩ␣), where ␣ is typically about 0.053. Intrinsic losses and the initial-and final-state rules a. Amplitude-reduction factor S 0 2 Intrinsic losses correspond to excitations that arise due to the creation of a core hole in the photoabsorption process. Although the theory of XAFS is often couched in a one-electron language, where a single electron makes a transition from a core orbital to an excited state, the process is truly many body, and other electrons are generally excited as well. Examples of intrinsic processes are the well-known shakeup and shakeoff excitations in which more than one electron is excited in a transition. This secondary emission results from a relaxation of the NϪ1 electron Fermi sea in response to the creation of a core hole. Because both of these processes involve the same final states, their quantum-mechanical amplitudes can in principle interfere, and hence one cannot simply add their transition rates. We review here the treatment of such intrinsic effects given byTo understand the origin of such intrinsic effects, one must examine the full many-body expression for the x-ray absorption spectrum,In the Hartree-Fock or density-functional-theory approximations, for example, the initial and final states are Slater determinants of one-particle states, calculated with different self-consistent one-electron potentials, i.e., the self-consistant-field approximation, as discussed, for example, bywhere the prime refers to states calculated in the presence of the core hole. Thus the absorption in the lowest energy or ''primary channel'' is reduced in magnitude from the one-particle expression by a many-body overlap integral,In this approximation the one-electron matrix element for the primary channel is consistent with the final-state rule, i.e., that the core orbital should be calculated with the initial ground-state Hamiltonian and the final state with the presence of a fully relaxed core hole (von

b. Excitations:
Because of these relaxation effects, the observed EX-AFS amplitudes are reduced from their one-electron values by a phenomenological factor, which is usually taken to be a constant. To see this, one must examine the contribution from excitations (seewhere the many-body overlap integral S n ϭ͗⌽ n Ј NϪ1 ͉⌽ 0 NϪ1 ͘; also, the energy of the photoelectron is reduced in accordance with energy conservation by the excitation energy E n . The quantity S n is usually small (for n 0) and would vanish by orthogonality in the absence of relaxation. Thus the total absorption in this approximation is equivalent to a convolution, i.e., to a broadened one-particle calculation:where ˜is the one-electron spectrum and A()adding the effect of extrinsic losses (which adds additional broadening) to this result is equivalent to calculating the photoelectron state f with a complex optical potential. Similar convolution expressions have also been derived with other formalisms, e.g., the generalized GW approach of͉⌽ n Ј (NϪ1) ͘. According to the Manne-Aberg theorem, the centroid of the excitation spectrum corresponds to Koopman's theorem for the transition energyThe initial-state rule states that the photoelectron should be calculated with the ground-state charge density (i.e., in the absence of a core hole). Such a photoelectron would then have a Koopman's energy given by the difference between one-electron eigenvalues. At low energies close to threshold, no additional excitations are allowed (by conservation of energy, the photoexcited electron needs sufficient energy to cause the additional excitations), and only the primary channel is available. This is consistent with the final-state rule, in which the core hole is fully relaxed, since such a photoelectron energy would include a relaxation energy. Conversely, at high energy all the possible channels are active, and the average energy of the excitation spectrum is centered around the Koopman's theorem value. Since the XAFS oscillations are widely spread out at high energies, one can view this spectrum as a smeared ␦ function, yielding results roughly equivalent to the initialstate rule.The above convolution was derived assuming that interference between extrinsic and intrinsic terms can be neglected, but this is not necessarily valid at low energies. One effect of this interference is the presence of ''replacement terms'' in the Hartree-Fock approach

c. Phasor sum:
The effect of intrinsic excitations for XAFS from paths with path length 2Rwhere k()ϭͱ, kЈ()ϭͱϪЈ, and A ˜() ϭA()/͐ 0 dЈA(Ј). At intermediate EXAFS energies, the denominator of A ˜is unity, and the phasor sum is dominated by the primary channel with the value S 0 2 , while at both low and very high energies S 2 reduces to unity. Thus, in general, instead of a constant S 0 2 , this result shows that the one-electron XAFS signal must be multiplied by an overall complex-valued amplitudereduction factor S 2 (E,R), which is weakly energy and path dependent. The overall effect is similar to a small additional contribution to the mean free path.

A. Multiple-scattering expansion:
The development of curved-wave multiple-scattering theory was a key step in the success of the modern theory of XAFS. This theory yields a unified treatment of XAFS, encompassing both EXAFS and XANES, as well as a formal equivalence between the multiplescattering expansion carried to all orders and exact treatments. For a review of the theory, see, for example,The starting point for the multiple-scattering theory of XAFSwhere f are final states with energies E f of the effective final-state one-particle Hamiltonian H including an appropriately screened core hole, which is described by the optical potential v(r)ϭVϩ⌺ (Sec. II.B), and ⌫ is a net lifetime, including effects of extrinsic and intrinsic losses.In terms of G, the absorption from a given core level c is given bywhere ⌫ is a broadened step function at the Fermi energy E F . It is now convenient to separate the problem into a single scatterer at the absorption site (which is taken to be the ''central atom'') and the remaining scatterers, which are treated in perturbation theory, i.e., G ϭG c ϩG sc . Here the local representations of G c and G scwhere Lϭ(l ,m), R L (r)ϭi l R l (r)Y L (r ˆ) is the regular solution to the Dyson equation, andThe main ingredients for the scattering part G sc are the dimensionless two-center free propagator G LR,L Ј R Ј 0 and the dimensionless scattering t matrix t LR,L Ј R Ј ϭe i␦ lR sin(␦ lR )␦ RR Ј ␦ L,L Ј . With these ingredients, the total scattering-propagator matrix G L Ј R Ј ,LR sc (E) can be obtained by matrix inversion from the full multiplescattering equations G sc ϭG LR,L Ј R Ј sc ϭexp(i␦ l ϩi␦ l Ј )(1 ϪG 0 t) Ϫ1 G 0 (matrix indices suppressed). Note that our scattering formalism is cast in terms of Green's-function propagators and phase shifts. A related approach based on the so-called scattering-path operators has also been used in many treatments of XANES (e.g., those ofAn important result of the multiple-scattering formalismwhere the brackets denote a thermal and configurational average, and the free propagator G 0 is defined to be zero when R ជ ϭR ជ Ј. This result shows that the atomic background absorption in XAFS is given by an energydependent, embedded-atom cross section 0 , i.e., the absorption for an atomiclike state is defined by the central potential v c rather than being that for a ''free atom''Here 0lЈ is the density of states for an embedded atom. Because of the similarity between and l Ј , it is widely thought that XANES essentially measures the projected density of stateswhen R ជ ϭR ជ Ј. Thus one sees immediately that the exact result, which is given by the full matrix inverse, can be expressed equivalently as a sum over all multiplescattering paths (provided, of course, that the series is convergent), and may be labeled by a path index ⌫, i.e.,(in matrix notation), in which each distinguishable pathHere t i is the scattering t matrix at site i, ␦ l is the partial-wave phase shift at the absorbing atom, and again, the outer brackets indicate a thermal and configurational average. The relativistic generalization of this formula is similar. The short-range-order theory of XAFS therefore amounts to retaining only a finite summation of the multiplescattering series, together with the inclusion of Debye-Waller factors and inelastic losses. Convergence of the multiple-scattering series is governed by several factors, such as the mean free path, the spherical factors (1/kR) for each leg of length R, the strength of the scattering at each site, and the exponential decay factor exp͓ϪR/(k)͔ due to the mean free path. Moreover, as shown, for example, by

B. Full multiple-scattering methods:
In the previous section we reviewed the multiplescattering expansion needed to calculate XAFS. Ideally, one might want to solve this set of equations exactly, which is equivalent to summing the expansion to infinite order. In practice, such an infinite summation requires a change of technique. In conventional electronicstructure approaches this summation can be reformulated in terms of a Hamiltonian that is diagonalized in order to solve for its eigenfunctions, or alternatively a matrix inversion of the multiple-scattering equations, Eq. (Given these powerful advantages, one can ask: why use a finite multiple-scattering approach for XAFS instead? Why not immediately jump to full-potential methods? The answer is, of course, their equally strong disadvantages for calculations not close to an x-ray edge:(1) such methods cannot easily include other important physics such as Debye-Waller factors, core-hole potentials, and final-state lifetime effects, which are crucial beyond about 50-100 eV of an edge; (2) they are computationally inefficient since they provide an unnecessarily high degree of detail about the electronic structure (all of the many excited-state eigenstates, van Hove sin-gularities, etc.), which are then washed out by the various broadenings and lifetime effects encountered in experiment; and (3) they are limited to the near-edge region because the number of basis-set functions and orbital angular momentum components that must be included is a rapidly increasing function of energy above the edge. Thus the physics of XANES and EXAFS differ in several key respects and require different algorithms for accurate treatments. Moreover, since exact methods have implicitly summed all scattering paths, one cannot disentangle this information to interpret the contributions from specific paths, which is needed to extract bond-length and bond-angle information. That is, such exact methods are not tuned into the atomic structure of the material, but instead are focused on indirect manifestations of the structure, for example, in densities of states.

Band-structure and exact diagonalization methods:
Exact diagonalization methods are particularly useful for XANES calculations. For example, the most successful early methods of band-structure calculation for crystalline solids were based on the same muffin-tin approximation as the multiple-scattering approach: the augmented plane-wave method and the Korringa-Kohn-Rostoker method. It has long been known that the two are equivalent. The chief difference is that the augmented plane wave uses an augmented plane-wave basis while the Korringa-Kohn-Rostoker is based on multiplescattering theory. The Korringa-Kohn-Rostoker method for a periodic crystal is, in fact, the solution to the infinite multiple-scattering expansion used in XAFS, if one ignores the core-hole and energy-dependent exchangecorrelation potential.In principle, the core hole could be taken into account in a band-structure approach by using the supercell technique, which is often used to calculate point defects in a crystal. In this technique, a number of unit cells are combined to form a larger unit cell (the supercell), which is then periodically repeated in all directions. Point defects (like the atom with the single core state missing) are placed near the center of the unit cell, and the system is converged until self-consistency is achieved. Supercells are usually tested for convergence as a function of cell size. The goal is to reduce defect-defect interactions by increasing the distance between their periodic replacements. In practice, this approach is expensive computationally, because of the large basis sets that must be diagonalized (diagonalization costs often go up as N 3 , where N is the number of basis functions, which typically scales linearly with the number of atoms in the unit cell).With respect to the energy-dependent exchangecorrelation potential, it is probably best to think of it in terms of a quasiparticle picture of excited states. Strictly speaking, this goes beyond the customary realm of bandstructure theory, which is mainly directed towards ground-state properties of solids. It has long been known that the energy eigenvalues of conventional LDA band-structure calculations are not true quasiparticle excitation energies. In practice, this distinction has been blurred by the often excellent agreement that occurs between these eigenvalues and the observed lowlying excitation energies. Recent advances in electronicstructure theory such as the computationally expensive GW approximation disscussed in Sec. II.C.2.a or other self-energy corrections have provided some guidance for calculations of the energies for excited statesAs noted above, most current electronic-structure methods are now full-potential techniques. This means that the muffin-tin approximation is superseded, and the full shape of the true electronic charge density and potential throughout all space is used. Such techniques yield very accurate results for calculating geometrical structures of the atoms (by minimizing the total energy of the system as a function of atomic positions). For XAFS calculations, such corrections are important only in the near-edge regime (XANES) for highly covalent materials with open structures. Well above the edge (the EXAFS regime) the kinetic energy of the excited photoelectron dominates and non-muffin-tin corrections appear to be negligible.The chief technical difficulty in using conventional band-structure techniques involves limitations in the choice of basis set. As the wave functions are calculated at higher and higher energies above the Fermi energy, more and more basis functions are needed. More specifically, successively higher orbital angular momentum components must be included (e.g, f, g, h, and higher), as well as higher principal quantum numbers (unoccupied states) for the same orbital angular momentum states that are occupied. The huge increase in basis size drastically increases computational cost, which often scales as the cube of the number of basis functions (for those methods that rely on diagonalization techniques). The wave functions are also very extended and become strongly hybridized. The number of energy eigenvalues also grows tremendously as a function of energy above the Fermi energy (for example, simple free-electron theory gives a quadratic density of states as a function of energy). The combination of these factors typically limits the effectiveness of most band-structure (as well as cluster) techniques for XAFS calculations to about 100 eV above the edge.

Full multiple-scattering cluster methods:
The full multiple-scattering cluster approach is intermediate between band-structure and path-by-path techniquesIt is perhaps easiest to discuss the main idea of the cluster approach from a pathlike analysis. As we mentioned earlier in this article, the main XAFS structure arises from quantum interference as the excited photoelectron scatters off nearby atoms. Since the photoelectron has a finite mean free path, in principle, one only needs to know the electronic structure of the photoelectron for a cluster of atoms around the absorbing site with a size of the order of the mean free path. This suggests that, whether one is investigating a periodic solid or a molecule, an electronic-structure calculation for a large enough cluster should provide all the relevant information needed for understanding an XAFS experiment.In practice there are some additional issues that should be carefully considered. The first is cluster size: the cluster chosen must be large enough so that the boundary conditions imposed by cutting off the cluster at some finite size do not significantly affect the electronic structure of the cluster in the region sampled by the excited photoelectron.Another consideration is diagonalization costs. As in the band-structure method discussed above, the basis set needed to handle highly excited photoelectrons must be drastically expanded. This requirement again usually restricts the applicability of cluster calculations to the first 100 eV or so above the absorption edge. Despite this limitation, there are some important advantages of the full multiple-scattering cluster approach, which make such calculations very useful in XANES applications of complex systems. For example, as in the band-structure approach, multiple scattering within the cluster is treated to all orders. Although Debye-Waller factors are neglected, they are relatively unimportant near the edge. Also, some systems, especially biological systems, often have no periodicity (i.e., they do not form in crystals) and have complex asymmetric geometries that would be nearly impossible to treat from a conventional bandstructure point of view (i.e., as a periodic crystal).As in band-structure calculations, all of the questions about constructing the potentials seen by the photoelectron and whether they can be treated by muffin-tin or full-potential LDA approaches arise. In addition, it is well known that there can be serious errors in an LDA approach for excited states, and Hartree-Fock or other excited-state approaches may be needed. In particular, it is often important to take into account the energy dependence of exchange-correlation effects.The muffin-tin approach can be dangerous for calculating optimized structures of small molecules by energy minimization techniques, since large fractions of the occupied-electron wave functions spill into the interstitial region between atoms, where there are consequently significant deviations from a constant potential. However, the high kinetic energy of the photoexcited electron is not particularly sensitive to these perturbations. One can therefore argue that muffin-tin approaches are adequate for the XAFS spectra even when such calculations give poor results for the ground-state properties of such systems. This also raises the issue of whether nonself-consistent potentials (e.g., calculated by overlapping atomic charge densities) may actually be better than self-consistent muffin-tin potentials. If the muffin-tin approximation is poor for the ground-state (nonexcited) electrons, self-consistency could actually drive the potential into a peculiar, less accurate regime.Like band structures, many different basis sets and approaches are possible. A commonly used cluster multiple-scattering approach is the X ␣ scattered-wave method

C. Path-by-path methods:
The path-by-path multiple-scattering approach has proved to be the most useful general method for analyzing EXAFS experiments. Its main advantages are its computational efficiency and accuracy; moreover, it provides a geometrical parametrization and interpretation of EXAFS, which is ideal for analyzing interatomic distances and other structural quantities. Fourier transforms of the XAFS indicate that the near neighbors generally give the dominant contributions, but also show that multiple-scattering contributions from more distant paths eventually dominate the signal. Although even merely enumerating the multiple-scattering paths can quickly become a computational bottleneck, since the number of paths of a given length grows exponentially with path length, this can be circumvented, as discussed below.

Exact path methods:
The path-by-path approach for calculating multiplescattering contributions to XAFS was pioneered by the work of

Small-atom approximations:
Several attempts to improve the plane-wave approximation have been made, using variants of the smallatom approximation

Separable approximation:
A major advance in XAFS theory, which overcomes all the major computational difficulties of the multiplescattering expansion, is based on a separable representation of the Green's-function propagators developed by the present authors(3) the need for correlated multiple-scattering Debye-Waller factors. The first difficulty, the angular momentum problem, was overcome in two steps. First, by using rotation matrices, successive bonds in a path can be rotated to the z axis, thereby reducing the problem to a calculation of ''z-axis propagators''The second step of the Rehr-Albers method is an exact, separable representation of the z-axis propagators, which was inspired by an earlier, low-energy approximation ofwhere RЉϭRЈϪR. The generalized spherical harmonic expansion coefficients Y and Y ˜converge rapidly in pow-ers of 1/kR, and hence the representation can usually be severely truncated. The approach becomes exact at low energies or for single scattering, and typically only six terms suffice to within experimental precision for the full range of wave numbers 1рkр20 Å Ϫ1 normally encountered in XAFS experiments. At lowest order or high energies the result becomes equivalent to the smallatom approximation discussed above. The advantage of the separable representation is that it permits one to combine and then sum all the factors involving L at a given site into a scattering matrix F Ј , ϭ ͚ L Y ˜Ј ,L t L Y L, , which is the analog of the scattering amplitude. Moreover, the method gives an accurate curved-wave XAFS formula directly analogous to that with the plane-wave approximation, but with the usual scattering amplitudes f() replaced by low-order (typically 6ϫ6) matrices F. The method can naturally be generalized to include off-diagonal t matrices with muffin-tin corrections. The efficiency of the Rehr-Albers approach is due to this truncated separable representation, as one can quickly multiply any number of 6ϫ6 matrices. Thus, for an N-leg path ⌫ with scatterers at R 1 ,R 2 , . . . ,R N ϭR 0 , the result for the XAFS amplitude isHere i ϭp(R i ϪR iϪ1 ), pϭͱEϪV mt is the photoelectron momentum measured with respect to the muffin-tin zero (in Rydberg atomic units), F i is the scattering matrix at site i, M l is the termination matrix for the final state of angular momentum l , S 0 2 is a many-body reduction factor, and ⌫ 2 is the mean-square variation in total path length R tot . The adequacy of 6ϫ6 matrices was verified by using the exact z-axis propagatorsThe second difficulty mentioned above is the pathproliferation problem. Fast multiple-scattering calculations of a given path are not enough to calculate XAFS for a material, due to exponential path proliferation. Fortunately, it turns out that the vast majority of multiple-scattering paths are of small amplitude and largely cancel, apart from tolerable random phase fluctuations. Thus the path-proliferation problem can be overcome by introducing ''filters'' in the path enumeration scheme to restrict the number of paths under consideration

D. Alternative methods and extensions:
Various alternatives to the path-by-path method have been discussed. For example, the group n or GNXAS method

E. Example of multiple-scattering approaches:
The Rehr-Albers approachAnother example of the accuracy of the Rehr-Albers multiple-scattering approach is the case of Cu metal (seeFinally,

A. Introduction:
The XAFS Debye-Waller factor arises as a natural consequence of fluctuations in interatomic distances. At FIG. 16. Comparison of the Fourier transform of multiplescattering calculations of (k) from the FEFF code in real space ͓(r)͔ with experiment (for Cu). This figure is redrawn from Fig. 2(b) of Zabinsky et al. (1995). finite temperatures, as the atoms vibrate around their equilibrium lattice sites, they slightly alter the interference pattern for a given path. The net signal results from an average of ͗e 2ikR ͘ over many paths, which tends to smudge details of the XAFS amplitude at higher values of k (shorter wavelength). This factor is analogous to that encountered in x-ray diffraction and generally adds an exponential decay factor to the XAFS amplitude

B. Formal properties:
The XAFS Debye-Waller factor can be viewed as a result of averaging the contribution to the XAFS signal from a given scattering path over all thermally accessible configurations of the atoms in that path. It is not necessary to distinguish between single-and multiple-TABLEPath R eff (Å) C cw (%) Label Degeneracy Legs Comment 1 2.56 100.00 11 12 2 ss, 1st shell 2 3.61 20.23 22 6 2 ss, 2nd shell 3 3.83 12.28 111 48 3 triangle 4 4.36 8.96 211 48 3 triangle 5 4.43 44.77 33 24 2 ss, 3rd shell 6 4.77 13.47 311 96 3 triangle 7 4.77 6.99 131 48 3 triangle 8 5.11 14.32 44 12 2 ss, 4th shell 9 5.11 32.63 411 24 3 shadow 10 5.11 7.17 141 12 3 linear 11 5.11 4.04 1111 48 4 dogleg 12 5.11 24.16 1111 12 4 shadow 13 5.11 8.74 1111 12 4 linear 14 5.30 4.02 321 48 3 triangle 15 5.30 4.55 312 48 3 triangle 16 5.71 6.15 313 48 3 triangle 17 5.72 19.93 55 24 2 ss, 5th shell 18 5.94 4.83 512 48 3 triangle 19 5.94 5.31 251 48 3 triangle 20 6.05 4.83 431 96 3 trianglescattering paths, since both are parametrized similarly in terms of an effective scattering amplitude f eff in the standard curved-wave XAFS formulawhere RϭR tot /2 denotes the mean half-total path length for a multiple-scattering path of total length R tot and instantaneous half-length r. In the remainder of this section we shall ignore the path-index subscript ⌫, unless it is needed explicitly.The thermal part of the average can be calculated from statistical-mechanical methods and a lattice Hamiltonian H (or dynamical matrix D), ͗e i2kr ͘ϭ Tr e Ϫ␤H e i2kr Tr e Ϫ␤H , (where ␤ϭ1/k B T. In addition, there may also be static disorder, which is obtained by a further configurational average. To the extent that thermal and configurational disorder are independent, their contributions to the net Debye-Waller factor are simply additive.TABLE II. Analysis to determine the relative importance of different types of paths for fcc Cu. The first 56 paths are sorted into categories. A total importance is defined as the sum of mean path amplitude factors (see caption for Table I for the meaning of this term) for each of the 56 paths. The importance column is this same sum, except restricted to the type of path listed in each row, and normalized so that the sum over all path types adds up to 100% (the total importance). The number column is the number of each type of path. The last line, all other paths, is the amplitude difference between the 56path run and a 1215-path run, and is a measure of the relative importance of paths beyond the first 56 paths. This table is the same as Table II of Zabinsky et al. (1995), where a more complete description is given. Number Importance (%) Path type 15 46.19 single scattering 15 24.23 shadow 4 4.40 linear 17 20.67 triangle 2 2.28 triangle, shadow leg 2 1.48 dogleg 1 .73 quadrilateral 1159 9.50 all other paths The main difference between the Debye-Waller factors in XAFS and those, for example, in x-ray diffraction, is the dependence of the XAFS Debye-Waller factor on displacement correlations. Only those displacements that change the total path length affect the interference pattern. To see this, let u i be the displacement from equilibrium of the ion at site i, so that, neglecting terms of order u i 2 , the effective path length for a scattering path with n legs isHere, iϩϭiϩ1 mod(n), Rϵ(1/2) ͚ i R iiϩ is, as before, the effective equilibrium half-path length, and R iiϩ is the equilibrium vector between atoms i and iϩ. From the Born-Oppenheimer approximation, the ion motion can be regarded as stationary during the photoexcitation process. Hence the thermal averages are to be carried out in the ground state prior to the x-ray absorption, rather than in the relaxed final states. Now, for any harmonic Hamiltonian or Gaussian disorder one has the exact resultHere, 2 denotes the mean-square fluctuation in the effective path length R, 2 ϭ(1/4)͓͗ ͚ iϭ1 n (u i Ϫu iϩ )•R ˆiiϩ ͔ 2 ͘. For example, in the single-scattering case with two atoms at sites 0 and R,The displacement correlations decay algebraically with distance, and the scalar products insure that only modes contributing to motion along a bond path are important. Therefore the XAFS Debye-Waller factor provides a measure of the displacement-displacement correlation function.As discussed byHere, ⌫ is an appropriate reduced mass for the scattering path ⌫, and max is the maximum frequency of the lattice motion. For example, for single scattering the projected density of modes iswhere denote the eigenfrequencies of the dynamical matrix D, and ⑀ R () the normalized eigenvectors. Equation-of-motion approaches for efficient calculations of ⌫ () and 2 , including quantum effects, have recently been discussed by

C. Phenomenological models:
Unfortunately, the dynamical matrix or even the local spring constants are not known in most cases of interest, and hence in practice one must often rely on simpler, phenomenological approximations. Two such methods are the correlated Debye and correlated Einstein models, which have been modified from the conventional Debye and Einstein models to approximately account for displacement-displacement correlations.

Correlated Debye model:
The correlated Debye model was introduced in XAFS theory byto 2 with a projected vibrational density of states for an atomic bond (0,R) of the formHere, D ϭk B D /ប is the Debye frequency, D is the Debye temperature, cϭ D /k D is the Debye approximation for the speed of sound, k D ϭ(6 2 N/V) 1/3 , and N/V is the atomic density number of the crystal. The second term in the brackets accounts for correlations and depends on bond length.

Correlated Einstein model:
The correlated Einstein model approximates the projected vibrational density of states with a single delta function, centered at the effective vibrational frequency E ⌫ for a given multiple-scattering path ⌫:The appropriate Einstein frequency E ⌫ can be interpreted

D. Radial distribution function:
The configurational and thermal average ͗¯͘ can be defined in terms of a radial distribution function appropriate to a given path. For weak disorder, the distribution function can be approximated by a Gaussian, with width 2 . Anharmonic corrections and any skew in the radial distribution generally lead to corrections to the Gaussian form of the Debye-Waller factor. Due to the limited data range of the XAFS (generally between about 2 and 20 Å Ϫ1 ), the precise nature of the radial distribution function cannot generally be determined. It is often useful, however, to parametrize this distribution function, particularly in disordered systems. Alternatively, one can define the XAFS entirely in terms of the contributions from the various irreducible n-atom distribution functions, as in the GNXAS approach

E. Cumulant expansion:
The cumulant momentswhere (n) denotes the nth cumulant average. The leading cumulants (with respect to the mean) are given by (see(3) ϭ͗͑rϪR ͒ 3 ͘,Explicit examples of such cumulants are discussed byIf not corrected for, the term with the third cumulant gives rise to an apparent contraction of distances extracted from XAFS experiment with increasing temperatureRecently it has been found that these anharmonic corrections can be roughly accounted for by taking advantage of certain algebraic relations between the cumulants. These relations have been derived by making use of an effective cubic, anharmonic pair potential V(x) ϭ(1/2)kx 2 ϩk 3 x 3 for a given path, where xϭrϪR. The effective coupling constants in these relations are those for an anharmonic correlated Einstein model that takes into account the interatomic potentials as well as contributions from neighboring springs(3) / j (1) j 2 (T)ϭ2. This relation breaks down at low temperatures TϽT D , but has been generalizedThus calculations of 2 (T) alone suffice to determine the anharmonic corrections up to an overall constant.Moreover,Here 0 2 ϭប͓2 E (R)͔ Ϫ1 is the zero-point contribution to 2 (T).There are a host of corrections to these results

V. CONCLUSIONS:
A series of remarkable advances in the theory of x-ray absorption spectroscopy has been made over the past few decades, spurred in part by the availability of modern synchrotron-radiation x-ray sources. As a result, the theory of extended x-ray absorption fine structure is now in a very mature state that provides a qualitative understanding of all the physical processes involved, as well as a detailed quantitative agreement with experiment. The key ingredients in the theory differ from those needed in conventional ground-state electronicstructure calculations and include high angular momentum scattering processes in a non-Hermitian optical potential and Debye-Waller factors to account for vibrations and disorder. Automated computer codes that implement the theory are now available for general materials. The success of the modern theory represents one of the few cases in which theoretical efforts have explicitly focused on the quantitative treatment of an experimental technique and shows what can be achieved with such a focus.A large factor in the success of the theory is the tractability of the physics in the regime in which it operates. In this case, the accuracy of the many approximations made is due largely to the high kinetic energy of the excited photoelectron, which dominates much of the physics. This also explains why EXAFS is such an excellent tool for probing local structure, since pathinterference effects at large wave numbers dominate other competing physics. Moreover, at high energies the one-electron theory is a good approximation, and manybody effects can be incorporated in an energydependent self-energy that can be well approximated by the local-density approximation. Also, at high energy, scattering is relatively weak and can be treated to an excellent approximation by a finite, albeit high-order, multiple-scattering expansion, in the short-range order theory. Indeed, the essential difference between EXAFS and XANES is found to lie in the strength of the scattering, with the crossover energy being typically about 30 eV or less. Interestingly, curved-wave corrections are important at all energies, and simpler approximations such as the plane-wave approximation or the spherical wave approximation are inadequate even at high energies. In addition, it suffices to use spherical approximations for the scattering potentials at high energies, e.g., the muffin-tin model, and to ignore self-consistency. Debye-Waller factors that account for displacementdisplacement correlations and disorder are especially important in achieving the correct amplitudes. Finally, an account of anharmonicity is important in order to achieve a proper understanding of the temperature dependence of the XAFS phase. Remarkably, the standard EXAFS equation ofAlthough most of the physical quantities needed in the theory can be determined by ab initio calculations, a few quantities must still be determined phenomenologically. These remaining, poorly known quantities mainly affect the EXAFS amplitudes. For example, the correlated Debye model, with the Debye temperature T D as a single fitting parameter, is often a reasonable approximation, although improvements are desirable in anisotropic systems. Moreover, it would be useful to have a fully ab initio procedure for the Debye-Waller factors and anharmonic corrections; this generalization would require total-energy calculations, which is presently impractical in general systems. Secondly, various manybody effects that determine the magnitude of the amplitude reduction factor S 0 2 are not quantitatively understood. Similarly, the behavior of the self-energy is currently based on rather simple electron-gas models and should be improved to achieve more accurate determinations of the mean free path and self-energy shifts. Thus, although the XAFS technique probes electronic excited states of the materials under investigation, the excited states themselves play a secondary role in modifying the basic interference fingerprint of the underlying fine structure. Nevertheless, such amplitudes and phases are critical to the application of the EXAFS technique to extract accurate distances and coordination numbers from experiment. While much work still needs to be done to refine various aspects of the theory and to make the tool more useful in extracting subtle structural details of complicated materials, the major pieces of physics are now well in hand.The most troubling and difficult aspects of x-ray absorption occur in the near-edge region. There the present theories are at best only in semiquantitative agreement with experiment. This is precisely where the dominance of the large kinetic energy of the excited photoelectron breaks down, and scattering and bonding effects are important. In this regime, the details of the spatially complex, potential-energy surface between atoms starts to become significant, and the complications of excited-state physics (e.g., intra-atomic excitations such as shakeup and shakeoff, exciton excitations, and resonance structures and phenomena) make the theory much less tractable and general. However, the factorization of XANES into an atomic background and XAFS contributions, i.e., ϭ 0 (1ϩ), can still be used to separate out the atomic and scattering contributions. The scattering contributions to the XANES appear in and must be treated with a full multiple-scattering approach when the multiple-scattering expansion breaks down. Moreover, much of the underlying near-edge phenomenon depends not just on the atomic structure of the material, but much more significantly on the details of the electronic structure (e.g., whether the system is a metal, insulator, or semiconductor). For example, the screening of the core hole appears to be system dependent and can dramatically affect the behavior of 0 . Similarly, there can be local-field corrections to the dipole operator and hence the atomic cross section can become important for shallow-core excitations. Thus the accurate calculation of the atomic background is an important challenge for future theories and is of critical importance to an accurate interpretation of XANES. It is for these reasons that this review has focused primarily on the fine structure in the higher-energy x-ray absorption.The success of EXAFS theory as a structural probe suggests the fruitfulness of extending the theory to related experimental probes such as electron energy-loss fine structure (see, for example,Hung, and S. I. Zabinsky, We also thank T. Fujikawa, L. Hedin, C.R. Natoli, and J. W. Wilkins for helpful comments and advice, and our experimental colleagues, in particular, K. Baberschke, G. E. Brown, S.

APPENDIX: MUFFIN-TIN RADII:
In a muffin-tin approach, an important consideration is the choice made for the size of the muffin tins. Since this is rarely, if ever, discussed in the literature, in this appendix we have collected the conventional wisdom about how such a choice may be rationally made and the pros and cons of different choices.Within a muffin-tin approximation it is important to optimize the calculation by adjusting the size of the muffin tins surrounding each atom (both the central atom whose core electron is being excited and neighboring atoms). Ideally, one would like to have a full-potential method for XAFS that would take into account the full spatial dependence of the charge density (see the discussion in Sec. II.B.2.a). In the absence of such a method, some reasonable choice has to be made for the muffintin radii of all the different atoms. Like all approximations, such a choice is based on intuition and experience. For XAFS one can try a number of ideas derived from the early history of electronic-structure calculations, when muffin-tin calculations were extensively employed.Muffin-tin approximations fall into two general classes: overlapping and nonoverlapping. The nonoverlapping case usually tries to maximize the radii so that the muffin tins touch or nearly touch. This is done to minimize the amount of interstitial region, where the potential is treated less accurately than inside the muffin tins. The overlapped case requires criteria for how big to make the muffin tins. This and related issues will be discussed below. Either case involves some choice of relative size for different types of atoms and how to scale them.Three different approaches to choosing relative radii are often employed:(1) Empirical radii based on experimental considerations of diverse phenomena such as Pauling, covalent, metallic, or other radii can be used to scale the relative size of different atomic muffin tins.(2) The muffin tins can be adjusted until the groundstate potentials (including Coulomb and exchange cor-relation) at the boundary of neighboring atoms are approximately equal(3)Conventional multiple-scattering theory involves nonoverlapping muffin-tin spheres. At one time this was regarded as the only available choice. More recently, some electronic-structure methods have analytically continued this approach to larger radii such that the different spheres overlap; see, for example, the method developed byWhether or not the spheres are overlapped, it is still necessary to choose the zero of energy in the interstitial region where the effective potential is considered to be a constant, since this determines the kinetic energy of the excited electron (the k vector). In close-packed crystalline solids there is a well-established procedure developed in the early days of electronic-structure calculations for nonoverlapping muffin tins. This procedure, which involves a simple averaging of the charge between the muffin-tin radius and the Wigner-Seitz radius, is discussed by

