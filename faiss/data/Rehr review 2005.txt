Introduction:
Significant progress has been made over the last several years in understanding the X-ray absorption near edge spectra (XANES), i.e. the structure in the spectra within about 30 eV of threshold where scattering is strong and inelastic losses are relatively weak. This progress has occurred in parallel with advances in synchrotron radiation X-ray sources and computer technology. The unprecedented precision now available in modern experimental probes of X-ray absorption spectra (XAS) underscores the need for improved theories for quantitative analysis of experiment. The progress in XANES is a sequel to the dramatic advances in theory of extended X-ray absorption fine structure (EXAFS). The basic theory of EXAFS is now well understood, as discussed in a recent reviewIn contrast to the now "standard" density functional theory (DFT) of ground state electronic structure, the theory of excited states is less well understood. Nevertheless, an analogous independent electron theory has emerged, in which the final states are represented as quasi-particles. This approach, which is the basis for much current work, will be referred to as the standard quasi-particle theory of XAS. The theory includes final state effects, such as the core-hole, inelastic losses, and vibrational effects, and replaces the ground state exchange-correlation functional with an energy dependent self-energy. Thus, the approach differs substantially from ground state theories. As a result, conventional band structure and quantum chemistry codes with ground state potentials are not usually appropriate for general XAS calculations, except close to threshold. This is illustrated in Fig.

Standard quasi-particle theory of XAS:
The basic independent-particle (i.e. quasi-particle) theory of XAS(Here hω + E i ≡ E is the photoelectron energy, d the coupling to the X-ray field, and E i is the (large negative) energy of the core level, and the sum is over unoccupied final states of energy E f . Most practical calculations are based on the reduction of the many-body Golden rule to a one-electron approximation and the dipole-approximation d = ˆ • r. Although the question of precisely which one-electron states to use is not unambiguous, much current work is based on the "final state rule," in which the final states |f are calculated in the presence of an appropriately screened core-hole, and all other many-body effects and inelastic losses are lumped into a complex valued and energy-dependent self-energy or optical potential Σ(E). This standard quasi-particle model is the basis for several XAS codes including FEFFHere h is the non-Hermitian final state Hamiltonian, V coul is the final state Coulomb potential, where the prime denotes quantities calculated in the presence of the screened core-hole potential, and Σ(E) is the photo-electron self-energy in the quasi-particle approximation.As noted above, the crucial difference between ground state electronic structure and excited states is the need for Σ(E) and the core-hole for excited states. The self-energy is essentially a dynamically screened exchange interaction, which is the analog of the exchange-correlation potential V xc of ground state density functional theory. Typically, the real part of the self energy, varies by about 10 eV over XAS energies, while the imaginary part is negative and varies by about 5 eV. Thus, this quantity accounts both for (extrinsic) inelastic losses or final-state broadening and systematic shifts in peak positions compared to those calculated with ground state theories.One of the key developments in practical XAS codes is an efficient algorithm for calculations of Σ(E) based on the GW approximation of Hedin. FEFF and other XAS codes usually use a local density approximation for Σ(E) based on the plasmon-pole dielectric constant; this is often referred to as the Hedin-Lundqvist self-energy. This approximation works well for EXAFS, and is close to the ground state DFT near threshold. However, the plasmon-pole self-energy tends to overestimate losses in the XANES as can be seen in Fig.Although the standard quasi-particle theory usually works well, all independent electron theories neglect many-body excitations, e.g. intrinsic losses due to the sudden creation of a core-hole. As a consequence, the standard theory usually overestimates the magnitude of the fine structure in the spectra, typically by about 10%. Moreover, the core-hole potential can be too strong (e.g. in Fig.

Real space multiple-scattering (RSMS) formalism:
An important formal development in XAS theory is the real-space multiple scattering (RSMS) approach. This method is the real-space analog of the KKR band structure methodThe calculations of final states in the Golden rule is often a computational bottleneck, and can only be carried out efficiently for highly symmetric systems such as atoms, small molecules, or periodic solids. However, many systems of interest lack symmetry. Also k-space (i.e. band structure) methodsthe Golden rule can be rewritten asThis formulation turns out to be advantageous for XAS calculations even in perfect crystals, since inelastic losses limit the range probed by XAS experiment to clusters typically of order a few hundred atoms about a given absorption site. This gives rise to a short range order theory. The cluster size is determined largely by the mean-free path, which is controlled by the core-hole and final state lifetimes. Moreover, at high energies, scattering is relatively weak and perturbation theory in the scattering potential converges well. The starting point in MS theory is the separation of the potential into contributions from "scattering potentials" v R localized on each atomic site RWithin MS theory, the propagator G( r , r, E) = L,L R L ( r)G L,L R L ( r ) is separable, so that the expression for µ in Eq. (where L = (l, m) denotes the angular momentum variables.Here and elsewhere we interchangeably use either the photoelectron energy E or the photon frequency ω to characterize the energy variation of the XAS. The relativistic generalizationThe calculation of the scattering potentials simplifies for electrons even of moderate energy, where the scattering depends strongly on the density in the core of an atom and spherical symmetry is a good approximation. Thus, at high energies self-consistency is not important, and the potentials are well described in terms of an overlapped atom approximation (i.e. the Mattheiss prescription). However, this approximation is inadequate for XANES where self-consistent field (SCF) calculations are almost always necessary. That is, the potentials, electron densities and the Fermi energy are iterated until they are self-consistent. A reason for this is that the atomic electronic configurations usually differ substantially from those in solids due to hybridization and chemical bonding. In the FEFF8 code, SCF potentials are implemented using the spherical or "muffin-tin approximation." However, this approach is adequate to obtain an accurate estimate of the Fermi energy E F and fractional occupations of the various valence states. The Fermi energy defines the threshold for the XANES; in molecules E F is typically midway between the highest occupied and the lowest unoccupied levels. Comparisons with accurate ground state electronic structure codes have verified the adequacy of this algorithm. Nevertheless, muffin-tin corrections can be important within a few eV of threshold, e.g. in anisotropic systems. Due to deviations from spherical symmetry some peaks are split and peak intensities are altered. Thus, the development of efficient full-potential RSMS approaches remains a challenge, which is under active development.In RSMS theory, the propagator G L,L naturally separates into intra-atomic contributions from the central atom G c and MS contributions from the environment G sc . Thus, G = G 0 + G sc , so that the XAS µ, can be factored asHence, the structure in the XAS µ depends both on the atomic background µ 0 and on the fine structure χ due to MS,, where the scattering contribution to G is given bywhere δ are partial-wave phase shifts. These results are consistent with the experimental definition of XAFS χ = (µ -µ 0 )/ µ 0 , where µ 0 is the jump in the atomic background absorption. For XANES, however, the MS expansion must generally be carried to very high or all orders (full MS), e.g. by matrix inversionwhere the successive terms represent single, double, . . . scattering processes.In general, one needs a combination of full multiple scattering and the path expansion to cover all energies of interest in XAS. Due to the large dimension of G, exact calculations with the path expansion can only be carried out for a few low-order MS pathsexcept that all quantities must be redefined to include curved wave and many-body effects implicitly. Usually only a subset of order 10 2 of the most important paths are adequate to represent the observed XAFS to high accuracy. Here k = [2(E -E 0 )] 1/2 is the wavenumber measured from threshold E 0 , λ k ≈ k/(|ImΣ| + Γ/2) is the XAFS mean-free path which is calculated in terms of the self-energy and core-hole lifetime. Finally, σ, which characterizes the thermal and structural disorder, is the rms fluctuation in the effective path length R = R path /2, which corresponds to peaks in the EX-AFS Fourier transform. The effects of thermal and structural disorder are of crucial importance in XAS at high energies, where they lead to a strong damping of the fine structure. This damping is usually dominated by an XAFS Debye-Waller factor exp(-2σ 2 k 2 ), where σ 2 is the correlated mean-square radial vibrational amplitude of the near-neighbor bonds, and varies inversely with the local bond strength. This damping factor is the analog of the Debye-Waller factor encountered in X-ray diffraction exp[-(1/2)k 2 u 2 ]. In XANES, where k is small (a few Å -1 ), the Debye-Waller factor is of order unity, and hence these terms are usually considerably less important. Moreover, we have found that they can be approximated to reasonable accuracy by including a correlated Debye-Waller factor exp(-σ 2 R,R k 2 ) in each propagator G LR,L R . However, there are some cases where structural disorder can lead to additional peaks in the spectra, which are normally forbidden by dipole selection rules. This underscores the utility of real-space codes compared to those based on crystalline periodicity.Higher moments of the pair distribution function are sometimes important, especially in temperature dependent investigations of XAS. One of the key theoretical developments in XAFS theory is the cumulant expansion which yields an efficient parameterization of such thermal and configurational disorderImproved treatments of XAFS Debye-Waller factors have recently been developed which go beyond the correlated Debye approximation

Fast parallel, Lanczos XANES calculations:
Due to the need for matrix inversion in full MS calculations, which scale in compute time as the cube of system size, XANES calculations are usually more time-consuming than EXAFS where the MS expansion converges typically with of order 10 2 paths. Indeed, full MS calculations become computationally intractable in the EXAFS regime or when (e.g. for low Z atoms) the mean free path is very long. This limitation has slowed attempts to use XANES in practical fitting schemes to extract chemical information in addition to geometric structure. Thus, one of the challenges in XANES theory has been to increase the computational speed. To this end, we have found that modern Lanczos algorithms are quite stable and can substantially improve computational speedEven more dramatic reductions in computational time can be obtained from parallel algorithms. The time for such algorithms scales as T 0 +T 1 /N, where N is the number of processors, and has been found to provide about two orders of magnitude further improvement

Comparison with other approaches:
Although we have focused on the RSMS approach here, many other one-particle methods are now used for calculating XANES. Each has its advantages and disadvantages and regions of validity.Conventional state quantum chemistry codes like GAUS-SIAN [25] and DMOL [26], band structure codes like the full potential LAPW code WIEN2KA significant improvement on pure ground state codes is the inclusion of a static screened core-hole potential, especially for the K-shell of insulators. This core-hole effect can be included in band-structure codes, e.g. with a super-cell approach and large units cells of order 10 2 atoms. This yields an approximation analogous to the final state rule. For example pseudopotential codes based on this approach have yielded XANES in reasonable agreement with experimentBy comparison, the RSMS approach method has several advantages for XAS calculations, since it includes the final state effects of the self-energy and the core-hole. Moreover, the method provides a relativistic all-electron real-space approach which is applicable over a wide energy range from threshold up to over 1 keV. Indeed, the RSMS method is currently the only approach capable of quantitative EX-AFS calculations at high energies. In contrast, due to basis set limitations, most ground state codes are limited to a few tens of eV from threshold. A current drawback of the RSMS method is the reliance on spherical muffin-tin potentials. However, efforts to develop full-potential real space approaches are in progress. For example the real-space approach of Joly et al.

Inelastic losses:
Theories of inelastic losses in XAS have a long historyRecently, there has been some progress in quantitative calculations of inelastic losses. Below, we briefly review the approach of Campbell et al.One of main results of the quasi-boson theory is an expression for the XAS as a convolution of the one-electron XAS µThe shape of the total spectral function A(ω,ω ) typically consists of a sharp primary "quasi-particle" peak of strength Z * ≈ 0.9 and width Im Σ, and a broad satellite. Formally, A is related to an "effective, one electron Green's function," A = (-1/π ) Im G eff which contains both quasi-particle and satellite peaks. The satellite terms characterize the multiple electron and plasmon excitations (e.g. shake-off) in the system. The one-electron XAS µ (The quasi-boson (oscillator) model Hamiltonian is similar to that introduced in Ref.The key result, obtained by an expansion to second order in the coupling functions V n , is an expression for the effective propagator G eff which includes, respectively, the extrinsic and intrinsic losses and (with a minus sign) interference termsHere the terms in ω n give rise to the satellite excitations. The functions G(ω) ≡ Z[ω -h -(ω) + iγ] -1 are damped Green's function calculated in the presence of a core-hole potential; they are equivalent to those in the standard quasi-particle model except for a renormalization constant Z of order exp(-a), where a ≈ 0.3 characterizes the dimensionless strength of the satellites. The above expression yields an expression for the spectral function A(ω,ω )and hence the XAS µ(ω) as an expansion in damped one-particle Green's functions. The approach, thus, avoids the calculation of correlated many-body final states using CI or other methods. Moreover, it is efficient since details in the shape of A are not essential, as they are averaged over in the convolution. The various contributions to the A can be represented as a sum of quasi-particle and satellite termsHere A qp represents the sharp quasi-particle peak and A sat (ω, ω ) = A extr (ω, ω ) + A intr (ω, ω ) -2A sat inter (ω, ω ) comes from the extrinsic and intrinsic satellites and tend to be suppressed by the interference satellites. Near threshold the net weight of each of the contributions A extr , A sat inter , and A intr is equal to the strength parameter a, and their shapes are similar, so that the sum of all of these contributions tend to cancel, thus, suppressing multi-electron excitations. Also near threshold the interference contribution to the quasi-particle peak a(ω) ≈ a. These results imply that the net strength of the main quasi-particle peak becomes nearly unity at threshold, Z exp(-a)(1 + 2a) → 1 + O(a 2 ) and hence, the standard quasi-particle model is recovered close to threshold.It is interesting to examine how the extrinsic and intrinsic losses and interference affect XAFS. Since the fine structure χ (1) (ω) is rapidly varying and energy dependent, the effect of a convolution µ (1) = µ 0 [1+ χQualitatively, the many-body amplitude reduction factor S 2 0 (ω, R) is weakly energy dependent, and reduces to unity (the quasi-particle limit) at low energies where interference is complete. Over a wide range, S 2 0 (ω, R) is roughly constant near about 0.9 and then smoothly increases toward unity at very high energies. As a result, various independent particle theories can be corrected for multiple-electron excitations using the quasi-boson approximation for the spectral function. As shown by Campbell et al.

Local field effects in XAS:
Although the standard quasi-particle model, is generally successful in describing XANES, it can sometimes fail near soft X-ray edges. A glaring example is the L 2,3 edges of 3d transition metalsThe TDLDAWithin the TDLDA, the XAS (or cross-section) µ(ω)can be expressed as an integral over the non-interacting response function χ 0 ( r, r , ω) and the screened X-ray field φ( r, ω). Then the XAS can be written asThis expression for the XAS µ in the TDLDA is equivalent to an analogous expression with d replaced by the external X-ray field d and χ 0 by the full response function χ = [1-χ 0 K] -1 χ 0 (ω)Here the interaction kernel K( r, r , ω) = V( r, r ) + f xc ( r, r , ω) denotes the particle-hole interaction (or TDLDA kernel), which contains direct and exchange parts, and V = 1/| r -r | is the Coulomb interaction. This TDLDA approach formalism fits well with the RSMS formalism used in FEFF8. In particular, the screening of both the X-ray field and the core-hole interaction only affects the particle-hole states and can be included implicitly in terms of renormalized dipole matrix elements. Otherwise the expression and hence the XAFS is unchanged. Thus, the XAS can be re-expressed aswhere MiL (ω) = R L | d|i . The implementation of the TDLDA approach evidently requires an adequate treatment of the exchange-correlation functional f xc (ω), which is much less well understood than the ground state functional. We have found that calculations of dynamical screening can be avoided for L 2,3 XAS by using a simplified dynamic TDLDA model, based on the BSE

Quantitative interpretation of XAS:
In independent developments, robust EXAFS analysis procedures have been developed based on the high-order MS path approach, as briefly reviewed in Ref.where E is the photoelectron energy, so that both share similar fine structure. As a result, one can deduce from experimental XAS measurements the unoccupied LDOS ρ(E) aswhere the factor γ(E) = ρ 0 (E)/µ 0 (E) is a smooth, atomic ratio, which includes the effects of the core-hole interaction in µ 0 . Peaks in the LDOSAs an example, we show in Fig.The SCF calculations also determine the fractional occupations of the various angular momentum states above the core levels. For the Ca atoms, one finds a solid state configuration of s 0.31 p 0.44 d 0.89 , i.e. with a net charge of +0.37, in contrast to an atomic configuration of s 2 . For the O atoms, the configuration is s 1.85 p 4.48 d 0.036 with a net charge of -0.37. These results show that the charge transfer to the O and Ca atoms is proportional to their valence, i.e. ±2 with a factor of about 0.2. The configuration of the Ca with the core-hole is s 0.36 p 0.54 d 1.54 , with a net charge of +0.44, showing that there is approximately one additional charge on the absorbing Ca atom which screens the core-hole. Similar factors have been observed in other cases as well, though it is not clear that this is a general rule.

Applications to X-ray spectroscopies:
The RSMS formalism outlined above has been incorporated in various XANES codes. For example the implementation in FEFF8 permits self-consistent calculations of both XAS and electronic structure. This code has already been applied extensivelyBecause the underlying physics is similar, the same RSMS approach can be applied to many other spectro-scopies, e.g. electron energy loss spectra (EELS)

Conclusions:
Codes based on RSMS theory now make possible a general treatment of XAS, encompassing XANES and EXAFS, as well as a number of other X-ray spectroscopies. The availability of a quantitative theory is key to an interpretation of the spectra in terms of local geometrical structure and electronic structure. The current state of XAFS is now highly quantitative and widely used. With reasonable estimates of the many-body amplitude factor, the error in fine structure amplitudes is usually less than 10%. With recent developments in algorithms and calculational speed, quantitative calculations and fits are rapidly becoming possible in XANES as well, although the agreement is still only semi-quantitative in many cases. Improved treatments of the self-energy, inelastic losses, and core-hole effects are clearly desirable. Also, efficient approaches for treating many-body corrections such as local field effects and inelastic losses have been developed, although these are not yet incorporated into widely available codes. Thus, XANES is beginning to realize its promise as a quantitative tool for elucidating both the coordination chemistry and electronic structure in materials.RR 01209, and was facilitated by the DOE Computational Materials Sciences Network.

